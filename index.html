<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GoldMinning - Gold Mining Game</title>
    <style>
        :root {
            --primary: #4a2c00;
            --accent: #FFD700;
            --secondary-gradient: linear-gradient(135deg, #FFD700, #FFA500);
            --background: linear-gradient(135deg, #87CEEB, #1E90FF);
            --text: #FFFFFF;
            --card-bg: #FFE4B5;
            --outline: #8B4513;
            --shadow: rgba(139, 69, 19, 0.5);
            --balance-green: #FF8C00; /* Changed to dark orange for balance and coins */
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Comic Sans MS', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background: var(--background);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            font-size: 14px;
            line-height: 1.4;
            text-shadow: 1px 1px 0 var(--outline);
        }
        
        .container {
            width: 100%;
            margin: 0 auto;
            padding: 0 10px;
        }
        
        /* Auth Styles - Cartoon Optimized */
        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: var(--background);
            padding: 15px;
        }
        
        .auth-box {
            background-color: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            width: 100%;
            max-width: 100%;
            box-shadow: 0 10px 25px var(--shadow), inset 0 0 15px rgba(255, 255, 255, 0.5);
            border: 5px solid var(--outline);
            position: relative;
            overflow: hidden;
        }
        
        .auth-box::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 15px;
            background: linear-gradient(to bottom, rgba(255,255,255,0.7), transparent);
            border-radius: 20px 20px 0 0;
        }
        
        .auth-tabs {
            display: flex;
            margin-bottom: 25px;
            border-bottom: 3px solid var(--outline);
            position: relative;
        }
        
        .auth-tab {
            padding: 12px 20px;
            cursor: pointer;
            font-weight: 800;
            color: var(--outline);
            transition: all 0.3s;
            font-size: 18px;
            text-shadow: 1px 1px 0 white;
            border-radius: 15px 15px 0 0;
            position: relative;
        }
        
        .auth-tab.active {
            color: var(--accent);
            background-color: var(--card-bg);
            border: 3px solid var(--outline);
            border-bottom: none;
            transform: translateY(3px);
            box-shadow: 0 -5px 10px rgba(0,0,0,0.1);
        }
        
        .auth-form {
            display: none;
        }
        
        .auth-form.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 16px;
            color: var(--outline);
            font-weight: 700;
            text-shadow: 1px 1px 0 white;
        }
        
        .form-control {
            width: 100%;
            padding: 16px 20px;
            border-radius: 15px;
            border: 3px solid var(--outline);
            background-color: rgba(255, 255, 255, 0.8);
            color: var(--outline);
            transition: all 0.3s;
            font-size: 18px;
            font-weight: 700;
            box-shadow: inset 0 0 10px rgba(139, 69, 19, 0.2);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.5), inset 0 0 10px rgba(139, 69, 19, 0.2);
        }
        
        .btn {
            padding: 18px 25px;
            border-radius: 20px;
            border: 3px solid var(--outline);
            font-weight: 800;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
            text-align: center;
            font-size: 18px;
            min-height: 60px;
            text-shadow: 1px 1px 0 var(--outline);
            position: relative;
            overflow: hidden;
        }
        
        .btn::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(to bottom, rgba(255,255,255,0.3), transparent);
            border-radius: 20px 20px 0 0;
        }
        
        .btn-primary {
            background: var(--secondary-gradient);
            color: var(--primary);
            width: 100%;
            box-shadow: 0 5px 0 #DAA520, 0 10px 15px var(--shadow);
        }
        
        .btn-primary:hover, .btn-primary:active {
            box-shadow: 0 3px 0 #DAA520, 0 5px 10px var(--shadow);
            transform: translateY(2px);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #FFE4B5, #FFD700);
            color: var(--outline);
            border: 3px solid var(--outline);
            padding: 14px 22px;
            min-height: 55px;
            box-shadow: 0 5px 0 #DAA520, 0 10px 15px var(--shadow);
        }
        
        .btn-secondary:hover, .btn-secondary:active {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            box-shadow: 0 3px 0 #DAA520, 0 5px 10px var(--shadow);
            transform: translateY(2px);
        }
        
        /* Dashboard Styles - Cartoon Optimized */
        .dashboard {
            display: none;
            min-height: 100vh;
        }
        
        .header {
            background: linear-gradient(135deg, #FFA500, #FF8C00);
            padding: 15px 0;
            border-bottom: 5px solid var(--outline);
            box-shadow: 0 5px 15px var(--shadow);
            position: relative;
        }
        
        .header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 10px;
            background: linear-gradient(to bottom, rgba(255,255,255,0.5), transparent);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .logo {
            font-size: 22px;
            font-weight: 800;
            color: var(--accent);
            display: flex;
            align-items: center;
            text-shadow: 2px 2px 0 var(--outline);
        }
        
        .logo span {
            margin-right: 10px;
            font-size: 24px;
            filter: drop-shadow(2px 2px 0 var(--outline));
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .balance-container {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 5px;
        }
        
        /* Changed balance and coin color to dark orange with medium bold font */
        .balance-display {
            font-size: 16px; /* Slightly reduced */
            font-weight: 600; /* Medium bold */
            color: var(--balance-green);
            text-shadow: 2px 2px 0 var(--outline);
        }
        
        .gems-display {
            font-size: 14px; /* Slightly reduced */
            font-weight: 600; /* Medium bold */
            color: #FF69B4;
            text-shadow: 2px 2px 0 #8B008B;
        }
        
        .user-rank {
            color: var(--balance-green);
            font-weight: 600; /* Medium bold */
            font-size: 12px; /* Slightly reduced */
            text-shadow: 1px 1px 0 #1a5276;
            background: linear-gradient(135deg, #AED6F1, #3498DB);
            padding: 5px 10px;
            border-radius: 10px;
            border: 2px solid #1a5276;
        }
        
        .announcement-icon {
            cursor: pointer;
            font-size: 20px; /* Slightly reduced */
            position: relative;
            padding: 8px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border-radius: 50%;
            border: 3px solid var(--outline);
            width: 40px; /* Slightly reduced */
            height: 40px; /* Slightly reduced */
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 0 #DAA520;
        }
        
        .announcement-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #e74c3c;
            color: white;
            border-radius: 50%;
            width: 20px; /* Slightly reduced */
            height: 20px; /* Slightly reduced */
            font-size: 11px; /* Slightly reduced */
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid white;
            box-shadow: 0 2px 0 #c0392b;
        }
        
        .main-content {
            padding: 20px 0;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            background-color: var(--card-bg);
            border-radius: 20px;
            padding: 20px;
            border: 4px solid var(--outline);
            box-shadow: 0 8px 0 #DAA520, 0 15px 20px var(--shadow);
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 10px;
            background: linear-gradient(to bottom, rgba(255,255,255,0.5), transparent);
            border-radius: 20px 20px 0 0;
        }
        
        .stat-card h3 {
            font-size: 16px;
            margin-bottom: 12px;
            color: var(--outline);
            text-shadow: 1px 1px 0 white;
        }
        
        .stat-value {
            font-size: 22px; /* Slightly reduced */
            font-weight: 600; /* Medium bold */
            color: var(--balance-green);
            text-shadow: 2px 2px 0 var(--outline);
        }
        
        .mining-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .mining-zone {
            width: 280px;
            height: 280px;
            border-radius: 50%;
            background: 
                radial-gradient(circle at 30% 20%, #87CEEB 0%, transparent 30%),
                radial-gradient(circle at 70% 25%, #87CEEB 0%, transparent 25%),
                radial-gradient(circle at 50% 80%, #2E8B57 0%, #228B22 30%, #006400 70%, transparent 100%);
            border: 5px solid var(--accent);
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            cursor: pointer;
            margin-bottom: 20px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.5), inset 0 0 30px rgba(255, 255, 255, 0.3);
            animation: pulse 2s infinite;
            touch-action: manipulation;
            overflow: hidden;
            filter: drop-shadow(0 10px 15px var(--shadow));
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 30px rgba(255, 215, 0, 0.5), inset 0 0 30px rgba(255, 255, 255, 0.3); }
            50% { box-shadow: 0 0 50px rgba(255, 215, 0, 0.7), inset 0 0 30px rgba(255, 255, 255, 0.5); }
            100% { box-shadow: 0 0 30px rgba(255, 215, 0, 0.5), inset 0 0 30px rgba(255, 255, 255, 0.3); }
        }
        
        /* Nature Elements */
        .sky {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 40%;
            background: linear-gradient(to bottom, #87CEEB, #B0E2FF);
            border-radius: 50% 50% 0 0;
            z-index: 1;
        }
        
        .grass {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60%;
            background: linear-gradient(to top, #2E8B57, #228B22, #006400);
            border-radius: 0 0 50% 50%;
            z-index: 1;
        }
        
        .plant {
            position: absolute;
            z-index: 2;
            filter: drop-shadow(2px 2px 0 #006400);
        }
        
        .plant-1 {
            bottom: 30%;
            left: 20%;
            width: 25px;
            height: 40px;
            background: 
                linear-gradient(to right, #32CD32, #228B22);
            clip-path: polygon(50% 0%, 100% 100%, 0% 100%);
            transform: rotate(-5deg);
            border-radius: 50% 50% 0 0;
        }
        
        .plant-2 {
            bottom: 25%;
            right: 25%;
            width: 20px;
            height: 35px;
            background: 
                linear-gradient(to right, #32CD32, #228B22);
            clip-path: polygon(50% 0%, 100% 100%, 0% 100%);
            transform: rotate(10deg);
            border-radius: 50% 50% 0 0;
        }
        
        .plant-3 {
            bottom: 35%;
            left: 60%;
            width: 28px;
            height: 50px;
            background: 
                linear-gradient(to right, #32CD32, #228B22);
            clip-path: polygon(50% 0%, 100% 100%, 0% 100%);
            transform: rotate(-15deg);
            border-radius: 50% 50% 0 0;
        }
        
        .plant-4 {
            bottom: 28%;
            right: 15%;
            width: 22px;
            height: 38px;
            background: 
                linear-gradient(to right, #32CD32, #228B22);
            clip-path: polygon(50% 0%, 100% 100%, 0% 100%);
            transform: rotate(5deg);
            border-radius: 50% 50% 0 0;
        }
        
        .plant-5 {
            bottom: 32%;
            left: 40%;
            width: 18px;
            height: 32px;
            background: 
                linear-gradient(to right, #32CD32, #228B22);
            clip-path: polygon(50% 0%, 100% 100%, 0% 100%);
            transform: rotate(-8deg);
            border-radius: 50% 50% 0 0;
        }
        
        .cloud {
            position: absolute;
            background: white;
            border-radius: 50%;
            z-index: 2;
            filter: drop-shadow(2px 2px 0 #B0C4DE);
        }
        
        .cloud-1 {
            top: 15%;
            left: 20%;
            width: 40px;
            height: 25px;
            opacity: 0.9;
        }
        
        .cloud-2 {
            top: 25%;
            right: 25%;
            width: 35px;
            height: 20px;
            opacity: 0.8;
        }
        
        .cloud-3 {
            top: 10%;
            right: 15%;
            width: 30px;
            height: 18px;
            opacity: 0.9;
        }
        
        .cobra-container {
            position: relative;
            width: 180px;
            height: 180px;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 3;
            filter: drop-shadow(3px 3px 0 #8B4513);
        }
        
        .cobra-snake {
            width: 150px;
            height: 150px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50,20 C60,10 80,15 80,30 C80,45 65,50 50,50 C35,50 20,45 20,30 C20,15 40,10 50,20 Z" fill="%23C5A100" stroke="%23FFD700" stroke-width="3"/><circle cx="40" cy="30" r="6" fill="%23000"/><circle cx="60" cy="30" r="6" fill="%23000"/><path d="M45,40 Q50,45 55,40" stroke="%23000" stroke-width="3" fill="none"/><path d="M50,50 C40,60 30,70 40,80 C50,90 60,85 60,75 C60,65 50,60 50,50 Z" fill="%23C5A100" stroke="%23FFD700" stroke-width="3"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            animation: cobraMove 3s infinite alternate;
        }
        
        @keyframes cobraMove {
            0% { transform: translateY(0) rotate(-5deg); }
            50% { transform: translateY(-8px) rotate(0deg); }
            100% { transform: translateY(0) rotate(5deg); }
        }
        
        .gold-pile {
            position: absolute;
            bottom: 30px;
            width: 70px;
            height: 40px;
            background: var(--secondary-gradient);
            border-radius: 10px 10px 5px 5px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.9), inset 0 0 10px rgba(255, 255, 255, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 4;
            border: 3px solid #DAA520;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .gold-pile:hover {
            transform: scale(1.1);
        }
        
        .gold-pile:active {
            transform: scale(0.95);
        }
        
        .gold-pile::before {
            content: "";
            position: absolute;
            width: 100%;
            height: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            top: 4px;
        }
        
        .gold-pile::after {
            content: "ðŸ’°";
            font-size: 22px;
            position: relative;
            z-index: 5;
            filter: drop-shadow(2px 2px 0 #DAA520);
        }
        
        .tap-instruction {
            margin-top: 15px;
            color: var(--outline);
            font-size: 16px;
            text-align: center;
            font-weight: 700;
            text-shadow: 1px 1px 0 white;
            background: rgba(255, 255, 255, 0.7);
            padding: 10px 20px;
            border-radius: 15px;
            border: 3px solid var(--outline);
        }
        
        .auto-mining-section {
            background-color: var(--card-bg);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 25px;
            border: 4px solid var(--outline);
            box-shadow: 0 8px 0 #DAA520, 0 15px 20px var(--shadow);
            position: relative;
            overflow: hidden;
        }
        
        .auto-mining-section::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 10px;
            background: linear-gradient(to bottom, rgba(255,255,255,0.5), transparent);
            border-radius: 20px 20px 0 0;
        }
        
        .auto-mining-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .auto-mining-header h3 {
            font-size: 18px;
            color: var(--outline);
            text-shadow: 1px 1px 0 white;
        }
        
        .auto-mining-toggle {
            position: relative;
            display: inline-block;
            width: 70px;
            height: 38px;
        }
        
        .auto-mining-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #FF6347, #FF4500);
            transition: .4s;
            border-radius: 34px;
            border: 3px solid var(--outline);
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.2);
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 28px;
            width: 28px;
            left: 3px;
            bottom: 3px;
            background: white;
            transition: .4s;
            border-radius: 50%;
            border: 2px solid var(--outline);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        input:checked + .slider {
            background: var(--secondary-gradient);
        }
        
        input:checked + .slider:before {
            transform: translateX(32px);
        }
        
        .timer-bar {
            height: 15px;
            background-color: rgba(139, 69, 19, 0.3);
            border-radius: 10px;
            margin-top: 15px;
            overflow: hidden;
            border: 3px solid var(--outline);
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.2);
        }
        
        .timer-progress {
            height: 100%;
            background: var(--secondary-gradient);
            width: 0%;
            transition: width 1s linear;
            box-shadow: inset 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        .timer-text {
            text-align: center;
            margin-top: 12px;
            font-size: 16px;
            color: var(--outline);
            font-weight: 700;
            text-shadow: 1px 1px 0 white;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }
        
        .feature-card {
            background-color: var(--card-bg);
            border-radius: 20px;
            padding: 20px;
            border: 4px solid var(--outline);
            box-shadow: 0 8px 0 #DAA520, 0 15px 20px var(--shadow);
            position: relative;
            overflow: hidden;
        }
        
        .feature-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 10px;
            background: linear-gradient(to bottom, rgba(255,255,255,0.5), transparent);
            border-radius: 20px 20px 0 0;
        }
        
        .feature-card h3 {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--outline);
            display: flex;
            align-items: center;
            gap: 10px;
            text-shadow: 1px 1px 0 white;
        }
        
        .feature-card p {
            font-size: 16px;
            margin-bottom: 15px;
            line-height: 1.4;
            color: var(--outline);
            text-shadow: 1px 1px 0 white;
        }
        
        .referral-code {
            background-color: rgba(255, 255, 255, 0.8);
            padding: 12px;
            border-radius: 15px;
            margin: 15px 0;
            font-family: monospace;
            text-align: center;
            border: 3px dashed var(--outline);
            font-size: 16px;
            word-break: break-all;
            font-weight: 700;
            color: var(--outline);
            text-shadow: 1px 1px 0 white;
        }
        
        .footer {
            background: linear-gradient(135deg, #FFA500, #FF8C00);
            padding: 20px 0;
            text-align: center;
            border-top: 5px solid var(--outline);
            margin-top: 30px;
            box-shadow: 0 -5px 15px var(--shadow);
            position: relative;
        }
        
        .footer::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 10px;
            background: linear-gradient(to bottom, rgba(255,255,255,0.5), transparent);
        }
        
        .footer p {
            color: var(--accent);
            font-size: 16px;
            border-bottom: 3px solid var(--accent);
            display: inline-block;
            padding-bottom: 5px;
            text-shadow: 2px 2px 0 var(--outline);
            font-weight: 800;
        }
        
        /* Modal Styles - Cartoon Optimized */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .modal-content {
            background-color: var(--card-bg);
            border-radius: 25px;
            padding: 25px;
            width: 100%;
            max-width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            border: 5px solid var(--outline);
            box-shadow: 0 15px 30px var(--shadow), inset 0 0 20px rgba(255, 255, 255, 0.5);
            position: relative;
        }
        
        .modal-content::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 15px;
            background: linear-gradient(to bottom, rgba(255,255,255,0.7), transparent);
            border-radius: 25px 25px 0 0;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 3px solid var(--outline);
            padding-bottom: 15px;
        }
        
        .modal-title {
            font-size: 24px;
            color: var(--outline);
            text-shadow: 1px 1px 0 white;
            font-weight: 800;
        }
        
        .close-modal {
            background: linear-gradient(135deg, #FF6347, #FF4500);
            border: 3px solid var(--outline);
            color: white;
            font-size: 28px;
            cursor: pointer;
            padding: 5px 12px;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 0 #c0392b;
            text-shadow: 1px 1px 0 var(--outline);
        }
        
        .close-modal:hover {
            box-shadow: 0 1px 0 #c0392b;
            transform: translateY(2px);
        }
        
        .terms-content {
            max-height: 45vh;
            overflow-y: auto;
            padding-right: 10px;
            margin-bottom: 20px;
            background: rgba(255, 255, 255, 0.7);
            padding: 15px;
            border-radius: 15px;
            border: 3px solid var(--outline);
        }
        
        .terms-content p {
            margin-bottom: 15px;
            line-height: 1.5;
            font-size: 16px;
            color: var(--outline);
            text-shadow: 1px 1px 0 white;
        }
        
        .agree-checkbox {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            font-size: 16px;
            color: var(--outline);
            text-shadow: 1px 1px 0 white;
            font-weight: 700;
        }
        
        .agree-checkbox input {
            margin-right: 10px;
            width: 22px;
            height: 22px;
            accent-color: var(--accent);
        }
        
        /* Announcements Styles */
        .announcement-item {
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 6px solid var(--accent);
            border: 3px solid var(--outline);
            box-shadow: 0 5px 10px var(--shadow);
        }
        
        .announcement-title {
            font-weight: 800;
            color: var(--outline);
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            font-size: 16px;
            text-shadow: 1px 1px 0 white;
        }
        
        .announcement-date {
            font-size: 14px;
            color: rgba(139, 69, 19, 0.8);
            text-shadow: 1px 1px 0 white;
        }
        
        .announcement-content {
            line-height: 1.4;
            font-size: 16px;
            color: var(--outline);
            text-shadow: 1px 1px 0 white;
        }
        
        .no-announcements {
            text-align: center;
            padding: 20px;
            color: var(--outline);
            font-size: 16px;
            text-shadow: 1px 1px 0 white;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 15px;
            border: 3px dashed var(--outline);
        }
        
        /* Staking Styles */
        .staking-item {
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 6px solid #FF69B4;
            border: 3px solid var(--outline);
            box-shadow: 0 5px 10px var(--shadow);
        }
        
        .staking-amount {
            font-weight: 800;
            color: var(--outline);
            margin-bottom: 8px;
            font-size: 16px;
            text-shadow: 1px 1px 0 white;
        }
        
        .staking-countdown {
            font-size: 14px;
            color: rgba(139, 69, 19, 0.8);
            text-shadow: 1px 1px 0 white;
        }
        
        .no-staking {
            text-align: center;
            padding: 20px;
            color: var(--outline);
            font-size: 16px;
            text-shadow: 1px 1px 0 white;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 15px;
            border: 3px dashed var(--outline);
        }
        
        .gem-animation {
            position: fixed;
            font-size: 26px;
            z-index: 10000;
            pointer-events: none;
            animation: gemFloat 2s ease-out forwards;
            filter: drop-shadow(2px 2px 0 #8B008B);
        }
        
        @keyframes gemFloat {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateY(-120px) scale(0.5);
                opacity: 0;
            }
        }

        /* Success Message Styles */
        .success-message {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--secondary-gradient);
            color: var(--primary);
            padding: 15px 25px;
            border-radius: 15px;
            font-weight: 800;
            z-index: 10000;
            box-shadow: 0 5px 0 #DAA520, 0 10px 20px var(--shadow);
            animation: slideDown 0.3s ease-out;
            font-size: 16px;
            border: 3px solid var(--outline);
            text-shadow: 1px 1px 0 white;
        }

        @keyframes slideDown {
            from {
                top: -100px;
                opacity: 0;
            }
            to {
                top: 20px;
                opacity: 1;
            }
        }

        /* Admin Panel Styles */
        .admin-section {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid var(--outline);
        }

        .admin-section h3 {
            font-size: 18px;
            color: var(--outline);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            text-shadow: 1px 1px 0 white;
        }

        .admin-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 3px solid var(--outline);
        }

        .admin-tab {
            padding: 10px 20px;
            cursor: pointer;
            font-weight: 800;
            color: var(--outline);
            transition: all 0.3s;
            font-size: 16px;
            text-shadow: 1px 1px 0 white;
            border-radius: 15px 15px 0 0;
        }

        .admin-tab.active {
            color: var(--accent);
            background-color: var(--card-bg);
            border: 3px solid var(--outline);
            border-bottom: none;
            transform: translateY(3px);
            box-shadow: 0 -5px 10px rgba(0,0,0,0.1);
        }

        .admin-panel-content {
            display: none;
        }

        .admin-panel-content.active {
            display: block;
        }

        .users-list {
            max-height: 250px;
            overflow-y: auto;
            margin-top: 15px;
            background: rgba(255, 255, 255, 0.7);
            padding: 15px;
            border-radius: 15px;
            border: 3px solid var(--outline);
        }

        .user-item {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 3px solid var(--outline);
            box-shadow: 0 3px 5px var(--shadow);
        }

        .user-info-small {
            flex: 1;
        }

        .user-email {
            font-weight: 800;
            margin-bottom: 5px;
            font-size: 16px;
            color: var(--outline);
            text-shadow: 1px 1px 0 white;
        }

        .user-stats {
            display: flex;
            gap: 15px;
            font-size: 14px;
            color: var(--outline);
            text-shadow: 1px 1px 0 white;
        }

        .user-actions {
            display: flex;
            gap: 10px;
        }

        .user-actions button {
            padding: 8px 12px;
            font-size: 14px;
            min-height: auto;
        }

        .refresh-btn {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border: 3px solid var(--outline);
            color: var(--outline);
            font-size: 18px; /* Slightly reduced */
            cursor: pointer;
            padding: 8px;
            margin-left: 10px;
            border-radius: 50%;
            width: 40px; /* Slightly reduced */
            height: 40px; /* Slightly reduced */
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 0 #DAA520;
            text-shadow: 1px 1px 0 white;
        }

        .refresh-btn:hover {
            box-shadow: 0 1px 0 #DAA520;
            transform: translateY(2px);
        }

        /* Three Dots Menu Styles */
        .menu-icon {
            cursor: pointer;
            font-size: 24px; /* Slightly reduced */
            padding: 8px;
            color: var(--outline);
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border-radius: 50%;
            width: 40px; /* Slightly reduced */
            height: 40px; /* Slightly reduced */
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px solid var(--outline);
            box-shadow: 0 3px 0 #DAA520;
            text-shadow: 1px 1px 0 white;
        }

        .menu-icon:hover {
            box-shadow: 0 1px 0 #DAA520;
            transform: translateY(2px);
        }

        .menu-dropdown {
            display: none;
            position: absolute;
            top: 60px;
            right: 10px;
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 15px;
            border: 4px solid var(--outline);
            box-shadow: 0 8px 0 #DAA520, 0 15px 20px var(--shadow);
            z-index: 100;
            min-width: 200px;
        }

        .menu-item {
            padding: 12px 18px;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s;
            font-size: 16px;
            color: var(--outline);
            text-shadow: 1px 1px 0 white;
            font-weight: 700;
            margin-bottom: 8px;
            border: 2px solid transparent;
        }

        .menu-item:hover {
            background-color: rgba(255, 215, 0, 0.3);
            border: 2px solid var(--outline);
            transform: translateY(-2px);
        }

        /* Welcome Animation Styles */
        .animation-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #0a1929, #1a3a5f);
            color: #f0f0f0;
            overflow: hidden;
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Comic Sans MS', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .welcome-scene {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: hidden;
            perspective: 1000px;
        }
        
        .welcome-ground {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 120px;
            background: linear-gradient(to top, #3a2c1a, #2a1c0a);
            z-index: 1;
            border-top: 5px solid #8B4513;
        }
        
        .welcome-mountain {
            position: absolute;
            bottom: 120px;
            left: 50%;
            transform: translateX(-50%);
            width: 400px;
            height: 240px;
            background: linear-gradient(to bottom, #3a2c1a, #2a1c0a);
            border-radius: 50% 50% 0 0;
            box-shadow: inset 0 0 60px rgba(0, 0, 0, 0.8);
            z-index: 10;
            border: 5px solid #8B4513;
        }
        
        .mine-entrance {
            position: absolute;
            bottom: 120px;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 80px;
            background: linear-gradient(to bottom, #1a0c00, #000);
            border-radius: 50% 50% 0 0;
            z-index: 15;
            box-shadow: 0 0 25px rgba(0, 0, 0, 0.9);
            border: 3px solid #8B4513;
        }
        
        .welcome-boy {
            position: absolute;
            bottom: 130px;
            width: 70px;
            height: 105px;
            z-index: 20;
            transform-style: preserve-3d;
            filter: drop-shadow(2px 2px 0 #000);
        }
        
        .boy-left {
            left: 20%;
        }
        
        .boy-right {
            right: 20%;
        }
        
        .boy-body {
            position: absolute;
            width: 35px;
            height: 60px;
            background: #8b4513;
            border-radius: 4px;
            bottom: 0;
            left: 18px;
            border: 2px solid #654321;
        }
        
        .boy-head {
            position: absolute;
            width: 26px;
            height: 26px;
            background: #f5d0a9;
            border-radius: 50%;
            bottom: 60px;
            left: 22px;
            border: 2px solid #d2b48c;
        }
        
        .boy-arm {
            position: absolute;
            width: 13px;
            height: 35px;
            background: #f5d0a9;
            border-radius: 4px;
            bottom: 45px;
            transform-origin: top center;
            border: 2px solid #d2b48c;
        }
        
        .boy-arm.left {
            left: 4px;
        }
        
        .boy-arm.right {
            right: 4px;
        }
        
        .boy-leg {
            position: absolute;
            width: 13px;
            height: 45px;
            background: #654321;
            border-radius: 4px;
            bottom: -25px;
            border: 2px solid #3a2c1a;
        }
        
        .boy-leg.left {
            left: 13px;
        }
        
        .boy-leg.right {
            right: 13px;
        }
        
        .gold-piece {
            position: absolute;
            width: 26px;
            height: 26px;
            background: radial-gradient(circle at 30% 30%, #ffd700, #daa520);
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
            z-index: 25;
            transform-style: preserve-3d;
            border: 2px solid #DAA520;
        }
        
        .welcome-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3.5rem;
            color: transparent;
            z-index: 100;
            text-align: center;
            font-weight: bold;
            letter-spacing: 4px;
            text-shadow: none;
            opacity: 0;
            filter: drop-shadow(3px 3px 0 #000);
        }
        
        .text-gold {
            background: linear-gradient(to bottom, #ffd700, #b8860b);
            -webkit-background-clip: text;
            background-clip: text;
            text-shadow: 0 0 25px rgba(255, 215, 0, 0.5);
        }
        
        .text-outline {
            color: transparent;
            -webkit-text-stroke: 2px #ffd700;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
        }
        
        .skip-button {
            position: absolute;
            bottom: 20px;
            right: 20px;
            padding: 12px 24px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border: 3px solid #8B4513;
            border-radius: 10px;
            color: #8B4513;
            font-weight: bold;
            cursor: pointer;
            z-index: 100;
            transition: all 0.3s;
            font-size: 16px;
            box-shadow: 0 5px 0 #DAA520;
            text-shadow: 1px 1px 0 white;
        }
        
        .skip-button:hover {
            background: linear-gradient(135deg, #FFA500, #FF8C00);
            box-shadow: 0 3px 0 #DAA520;
            transform: translateY(2px);
        }
        
        .particles {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 5;
        }
        
        .spark {
            position: absolute;
            width: 6px;
            height: 6px;
            background: #ffd700;
            border-radius: 50%;
            box-shadow: 0 0 12px 2px #ffd700;
            opacity: 0;
            z-index: 40;
        }
        
        @keyframes throw-left-to-right {
            0% { 
                left: 20%; 
                bottom: 170px;
                transform: scale(1) rotateY(0deg);
            }
            50% { 
                left: 50%; 
                bottom: 250px;
                transform: scale(1.2) rotateY(180deg);
            }
            100% { 
                left: 80%; 
                bottom: 170px;
                transform: scale(1) rotateY(360deg);
            }
        }
        
        @keyframes throw-right-to-left {
            0% { 
                left: 80%; 
                bottom: 170px;
                transform: scale(1) rotateY(0deg);
            }
            50% { 
                left: 50%; 
                bottom: 250px;
                transform: scale(1.2) rotateY(180deg);
            }
            100% { 
                left: 20%; 
                bottom: 170px;
                transform: scale(1) rotateY(360deg);
            }
        }
        
        @keyframes throw-to-screen {
            0% { 
                left: 20%; 
                bottom: 170px;
                transform: scale(1);
            }
            50% { 
                left: 50%; 
                bottom: 40%;
                transform: scale(2);
            }
            100% { 
                left: 50%; 
                bottom: 40%;
                transform: scale(25);
                opacity: 0;
            }
        }
        
        @keyframes arm-throw {
            0% { transform: rotate(0deg); }
            50% { transform: rotate(-60deg); }
            100% { transform: rotate(0deg); }
        }
        
        @keyframes arm-catch {
            0% { transform: rotate(0deg); }
            50% { transform: rotate(30deg); }
            100% { transform: rotate(0deg); }
        }
        
        @keyframes text-reveal {
            0% { 
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5);
                letter-spacing: 15px;
            }
            70% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.1);
                letter-spacing: 4px;
            }
            100% { 
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
                letter-spacing: 4px;
            }
        }
        
        @keyframes spark-animation {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(2); }
        }
        
        @keyframes boy-bounce {
            0% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
            100% { transform: translateY(0); }
        }

        /* Store Styles */
        .store-packages {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .package-item {
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 3px solid var(--outline);
            box-shadow: 0 5px 10px var(--shadow);
            transition: all 0.3s;
        }

        .package-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--shadow);
        }

        .package-item h3 {
            font-size: 18px;
            margin-bottom: 10px;
            color: var(--outline);
            text-shadow: 1px 1px 0 white;
        }

        .package-item p {
            font-size: 16px;
            margin-bottom: 15px;
            color: var(--outline);
            text-shadow: 1px 1px 0 white;
        }

        .package-item .btn {
            min-height: 45px;
            font-size: 16px;
        }

        .coupon-section {
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            padding: 20px;
            border: 3px solid var(--outline);
            box-shadow: 0 5px 10px var(--shadow);
            margin-top: 20px;
        }

        .coupon-section h3 {
            font-size: 18px;
            margin-bottom: 10px;
            color: var(--outline);
            text-shadow: 1px 1px 0 white;
        }

        .coupon-section p {
            font-size: 16px;
            margin-bottom: 15px;
            color: var(--outline);
            text-shadow: 1px 1px 0 white;
        }

        .pending-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .pending-content {
            background-color: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            border: 5px solid var(--outline);
            box-shadow: 0 10px 25px var(--shadow), inset 0 0 15px rgba(255, 255, 255, 0.5);
            max-width: 300px;
        }

        .pending-content h3 {
            font-size: 24px;
            margin-bottom: 15px;
            color: var(--outline);
            text-shadow: 1px 1px 0 white;
        }

        .pending-content p {
            font-size: 16px;
            margin-bottom: 20px;
            color: var(--outline);
            text-shadow: 1px 1px 0 white;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(139, 69, 19, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent);
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Responsive Adjustments */
        @media (max-width: 480px) {
            .container {
                padding: 0 8px;
            }
            
            .auth-box {
                padding: 20px;
            }
            
            .auth-tab {
                padding: 10px 15px;
                font-size: 16px;
            }
            
            .btn {
                padding: 16px 22px;
                font-size: 16px;
                min-height: 55px;
            }
            
            .mining-zone {
                width: 240px;
                height: 240px;
            }
            
            .cobra-container {
                width: 150px;
                height: 150px;
            }
            
            .cobra-snake {
                width: 120px;
                height: 120px;
            }
            
            .stat-card {
                padding: 15px;
            }
            
            .stat-value {
                font-size: 20px;
            }
            
            .feature-card {
                padding: 18px;
            }
            
            .modal-content {
                padding: 20px;
            }

            .success-message {
                padding: 12px 20px;
                font-size: 14px;
            }

            .user-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .user-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .welcome-text {
                font-size: 2.5rem;
            }
            
            .welcome-boy {
                transform: scale(0.7);
            }
            
            .boy-left {
                left: 15%;
            }
            
            .boy-right {
                right: 15%;
            }

            .store-packages {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 360px) {
            .mining-zone {
                width: 220px;
                height: 220px;
            }
            
            .cobra-container {
                width: 130px;
                height: 130px;
            }
            
            .cobra-snake {
                width: 105px;
                height: 105px;
            }
            
            .logo {
                font-size: 18px;
            }
            
            .balance-display {
                font-size: 16px;
            }
            
            .welcome-text {
                font-size: 2rem;
            }
            
            .welcome-boy {
                transform: scale(0.6);
            }
            
            .boy-left {
                left: 10%;
            }
            
            .boy-right {
                right: 10%;
            }
        }
        
        /* Prevent zoom on input focus for iOS */
        @media screen and (max-width: 767px) {
            input, select, textarea {
                font-size: 16px !important;
            }
        }
    </style>
</head>
<body>
    <!-- Welcome Animation Container -->
    <div id="animationContainer" class="animation-container">
        <div class="welcome-scene">
            <div class="particles" id="particles"></div>
            <div class="welcome-ground"></div>
            <div class="welcome-mountain">
                <div class="mine-entrance"></div>
            </div>
            
            <!-- Left Boy -->
            <div class="welcome-boy boy-left" id="boyLeft">
                <div class="boy-head"></div>
                <div class="boy-body"></div>
                <div class="boy-arm left" id="leftBoyLeftArm"></div>
                <div class="boy-arm right" id="leftBoyRightArm"></div>
                <div class="boy-leg left"></div>
                <div class="boy-leg right"></div>
            </div>
            
            <!-- Right Boy -->
            <div class="welcome-boy boy-right" id="boyRight">
                <div class="boy-head"></div>
                <div class="boy-body"></div>
                <div class="boy-arm left" id="rightBoyLeftArm"></div>
                <div class="boy-arm right" id="rightBoyRightArm"></div>
                <div class="boy-leg left"></div>
                <div class="boy-leg right"></div>
            </div>
            
            <!-- Gold Piece -->
            <div class="gold-piece" id="goldPiece"></div>
            
            <!-- Welcome Text -->
            <div class="welcome-text" id="welcomeText">
                <div class="text-outline">Welcome to</div>
                <div class="text-gold">Gold Mining</div>
            </div>
        </div>
        
        <button class="skip-button" id="skipButton">Enter Site</button>
    </div>

    <!-- Authentication Section -->
    <div id="authSection" class="auth-container">
        <div class="auth-box">
            <div class="auth-tabs">
                <div class="auth-tab active" id="loginTab">Sign In</div>
                <div class="auth-tab" id="signupTab">Create Account</div>
            </div>
            
            <form id="loginForm" class="auth-form active">
                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="loginReferral">Referral Code (Optional)</label>
                    <input type="text" id="loginReferral" class="form-control">
                </div>
                <button type="submit" class="btn btn-primary">Sign In</button>
            </form>
            
            <form id="signupForm" class="auth-form">
                <div class="form-group">
                    <label for="signupEmail">Email</label>
                    <input type="email" id="signupEmail" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="signupPassword">Password</label>
                    <input type="password" id="signupPassword" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="signupPhone">Phone Number</label>
                    <input type="tel" id="signupPhone" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="signupReferral">Referral Code (Optional)</label>
                    <input type="text" id="signupReferral" class="form-control">
                </div>
                <button type="submit" class="btn btn-primary">Create Account</button>
            </form>
            
            <div id="authMessage" style="margin-top: 15px; text-align: center; color: #ff6b6b; display: none; font-size: 16px; font-weight: 700; text-shadow: 1px 1px 0 white;"></div>
        </div>
    </div>
    
    <!-- Dashboard Section -->
    <div id="dashboardSection" class="dashboard">
        <header class="header">
            <div class="container">
                <div class="header-content">
                    <div class="logo">
                        <span>ðŸ†</span> GoldMinning
                    </div>
                    <div class="user-info">
                        <div class="balance-container">
                            <div class="balance-display" id="balanceDisplay">0 Coins</div>
                            <div class="gems-display" id="gemsDisplay">ðŸ’Ž 0 Gems</div>
                        </div>
                        <div class="user-rank" id="userRank">Rank 1</div>
                        <button class="refresh-btn" id="refreshBtn" title="Refresh Balance">ðŸ”„</button>
                        <div class="announcement-icon" id="announcementIcon">
                            ðŸ“¢
                            <div class="announcement-badge" id="announcementBadge" style="display: none;">0</div>
                        </div>
                        <div class="menu-icon" id="menuIcon">â‹¯</div>
                        <div class="menu-dropdown" id="menuDropdown">
                            <div class="menu-item" id="instructionsMenuItem">ðŸ“‹ Instructions</div>
                            <div class="menu-item" id="termsMenuItem">ðŸ“œ Terms & Conditions</div>
                            <div class="menu-item" id="customerServiceMenuItem">ðŸ‘¨â€ðŸ’¼ Customer Service</div>
                            <div class="menu-item" id="storeMenuItem">ðŸ›’ Store</div>
                            <div class="menu-item" id="logoutMenuItem">ðŸšª Logout</div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        
        <main class="main-content">
            <div class="container">
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Total Balance</h3>
                        <div class="stat-value">
                            <div id="totalBalance">0 Coins</div>
                            <div id="totalGems">ðŸ’Ž 0 Gems</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <h3>Referrals</h3>
                        <div class="stat-value" id="referralCount">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Auto Mining</h3>
                        <div class="stat-value" id="autoMiningStatus">Inactive</div>
                    </div>
                </div>
                
                <div class="mining-area">
                    <div class="mining-zone" id="miningZone">
                        <!-- Sky and Nature Background -->
                        <div class="sky"></div>
                        <div class="grass"></div>
                        
                        <!-- Plants -->
                        <div class="plant plant-1"></div>
                        <div class="plant plant-2"></div>
                        <div class="plant plant-3"></div>
                        <div class="plant plant-4"></div>
                        <div class="plant plant-5"></div>
                        
                        <!-- Clouds -->
                        <div class="cloud cloud-1"></div>
                        <div class="cloud cloud-2"></div>
                        <div class="cloud cloud-3"></div>
                        
                        <!-- Cobra and Gold Pile -->
                        <div class="cobra-container">
                            <div class="cobra-snake"></div>
                            <div class="gold-pile"></div>
                        </div>
                    </div>
                    <div class="tap-instruction">Tap the gold pile to mine coins!</div>
                </div>
                
                <div class="auto-mining-section">
                    <div class="auto-mining-header">
                        <h3>Auto Mining</h3>
                        <label class="auto-mining-toggle">
                            <input type="checkbox" id="autoMiningToggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="timer-bar">
                        <div class="timer-progress" id="timerProgress"></div>
                    </div>
                    <div class="timer-text" id="timerText">Auto Mining: Inactive</div>
                </div>
                
                <div class="features-grid">
                    <div class="feature-card">
                        <h3>ðŸ’Ž Stake Coins</h3>
                        <p>Stake your coins to earn gems! 2000 coins = 1 gem after 3 days.</p>
                        <button class="btn btn-primary" id="stakeCoinsBtn">Stake Coins</button>
                    </div>
                    
                    <div class="feature-card">
                        <h3>â³ Active Staking</h3>
                        <div id="activeStakingList">
                            <div class="no-staking">No active staking</div>
                        </div>
                    </div>
                    
                    <div class="feature-card">
                        <h3>ðŸ›’ Store</h3>
                        <p>Buy diamonds to use for exclusive features!</p>
                        <button class="btn btn-primary" id="storeBtn">Open Store</button>
                    </div>
                    
                    <div class="feature-card">
                        <h3>ðŸ‘¥ Referral System</h3>
                        <p>Invite friends and earn rewards!</p>
                        <div class="referral-code" id="referralCode">Loading...</div>
                        <p>Share this code with friends when they sign up</p>
                    </div>
                    
                    <div class="feature-card">
                        <h3>ðŸ’° Deposit</h3>
                        <p>To deposit, contact your Assistant Mining Agent.</p>
                        <button class="btn btn-primary" style="margin-top: 12px;">Contact Agent</button>
                    </div>
                    
                    <div class="feature-card">
                        <h3>ðŸ’¸ Withdrawal</h3>
                        <p>Withdrawals will open once the coin price is officially announced.</p>
                        <button class="btn btn-secondary" style="margin-top: 12px;" disabled>Withdraw Locked</button>
                    </div>
                </div>
            </div>
        </main>
        
        <footer class="footer">
            <div class="container">
                <p>Powered by | GoldMinning</p>
            </div>
        </footer>
    </div>
    
    <!-- Terms & Conditions Modal -->
    <div id="termsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ðŸ“œ Terms & Conditions</h2>
                <button class="close-modal" id="closeTermsModal">&times;</button>
            </div>
            <div class="terms-content">
                This is a skill-based mining game where users earn through manual tapping or auto-mining. To participate, users must deposit $1 to unlock mining access until the official price is announced. The price will be revealed within the range of $0.00003 to $0.7, with a chance of adjustment according to the rules made by the company in the future. Users may experience either profit or partial loss depending on the final value. The earnings represent in-game effort and do not guarantee any financial return.

Each user is allowed only one account per Gmail and phone number. Auto-mining runs for 2 hours at a time and must be restarted once the session ends. Withdrawals will remain locked until the price is officially declared. The deposit section contains the contact details of Assistant Mining Agents for user guidance and assistance.

The referral system enables users to grow faster and unlock exclusive rewards. Users who reach the Senior Assistant Level may become eligible to earn up to $200 per month, subject to official company confirmation via email. To qualify, a user must achieve 30 referrals in one week, 90 in three weeks, and maintain at least two referrals per day thereafter.

Any use of auto-tapping, hacking, or cheating tools is strictly prohibited and will result in a permanent account ban. By clicking or playing, you acknowledge that you have read and accepted these Terms and Conditions and agree to follow all game rules.

The name of this game does not imply ownership of any real gold, mine, or physical assetâ€”it is purely a virtual skill-based experience for entertainment and reward purposes.
            </div>
            <div class="agree-checkbox">
                <input type="checkbox" id="agreeCheckbox">
                <label for="agreeCheckbox">I agree to the Terms & Conditions</label>
            </div>
            <button class="btn btn-primary" id="agreeButton" disabled>I Agree</button>
        </div>
    </div>
    
    <!-- Announcements Modal -->
    <div id="announcementsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ðŸ“¢ Announcements</h2>
                <button class="close-modal" id="closeAnnouncementsModal">&times;</button>
            </div>
            <div id="announcementsList">
                <div class="no-announcements">No announcements available</div>
            </div>
        </div>
    </div>
    
    <!-- Staking Modal -->
    <div id="stakingModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ðŸ’Ž Stake Coins</h2>
                <button class="close-modal" id="closeStakingModal">&times;</button>
            </div>
            <div class="form-group">
                <label for="stakeAmount">Amount to Stake (minimum 2000 coins)</label>
                <input type="number" id="stakeAmount" class="form-control" min="2000" step="1" value="2000">
                <div style="margin-top: 10px; color: var(--outline); text-shadow: 1px 1px 0 white; font-weight: 700;">
                    You will receive: <span id="gemsToReceive">1</span> ðŸ’Ž
                </div>
            </div>
            <button class="btn btn-primary" id="confirmStakeBtn">Stake Now</button>
        </div>
    </div>

    <!-- Store Modal -->
    <div id="storeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ðŸ›’ Diamond Store</h2>
                <button class="close-modal" id="closeStoreModal">&times;</button>
            </div>
            <div class="store-packages">
                <div class="package-item">
                    <h3>10 Diamonds</h3>
                    <p>Price: $0.30</p>
                    <button class="btn btn-primary" data-diamonds="10" data-price="0.30">Buy Now</button>
                </div>
                <div class="package-item">
                    <h3>25 Diamonds</h3>
                    <p>Price: $0.50</p>
                    <button class="btn btn-primary" data-diamonds="25" data-price="0.50">Buy Now</button>
                </div>
                <div class="package-item">
                    <h3>40 Diamonds</h3>
                    <p>Price: $1.00</p>
                    <button class="btn btn-primary" data-diamonds="40" data-price="1.00">Buy Now</button>
                </div>
            </div>
            <div class="coupon-section">
                <h3>Redeem Coupon</h3>
                <p>Enter your coupon code below:</p>
                <input type="text" id="couponCode" class="form-control" placeholder="Enter coupon code">
                <button class="btn btn-secondary" id="submitCouponBtn">Submit</button>
            </div>
        </div>
    </div>

    <!-- Pending Popup -->
    <div id="pendingPopup" class="pending-popup">
        <div class="pending-content">
            <div class="spinner"></div>
            <h3>Processing</h3>
            <p>Your purchase is pending. Please wait for confirmation.</p>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ðŸ”§ Admin Panel</h2>
                <button class="close-modal" id="closeAdminModal">&times;</button>
            </div>
            
            <div class="admin-tabs">
                <div class="admin-tab active" id="announcementsTab">Announcements</div>
                <div class="admin-tab" id="usersTab">Manage Users</div>
                <div class="admin-tab" id="personalTab">Personal Messages</div>
            </div>
            
            <!-- Announcements Tab -->
            <div id="announcementsContent" class="admin-panel-content active">
                <div class="admin-section">
                    <h3>ðŸ“¢ Send Announcement</h3>
                    <div class="form-group">
                        <label>Title</label>
                        <input type="text" id="announcementTitle" class="form-control">
                    </div>
                    <div class="form-group">
                        <label>Content</label>
                        <textarea id="announcementContent" class="form-control" rows="4"></textarea>
                    </div>
                    <button class="btn btn-primary" id="sendAnnouncementBtn">Send Announcement</button>
                </div>
            </div>
            
            <!-- Users Tab -->
            <div id="usersContent" class="admin-panel-content">
                <div class="admin-section">
                    <h3>ðŸ‘¥ Manage Users</h3>
                    <button class="btn btn-secondary" id="loadUsersBtn">Load All Users</button>
                    <div class="users-list" id="usersList">
                        <!-- Users will be loaded here -->
                    </div>
                </div>
                
                <div class="admin-section">
                    <h3>ðŸ‘¤ Manage Specific User</h3>
                    <div class="form-group">
                        <label>User ID</label>
                        <input type="text" id="userIdForRank" class="form-control" placeholder="Enter user UID">
                    </div>
                    <div class="form-group">
                        <label>New Rank (1-4)</label>
                        <select id="newUserRank" class="form-control">
                            <option value="1">Rank 1 - Beginner</option>
                            <option value="2">Rank 2 - Intermediate</option>
                            <option value="3">Rank 3 - Advanced</option>
                            <option value="4">Rank 4 - Expert</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" id="updateRankBtn">Update Rank</button>
                </div>
                
                <div class="admin-section">
                    <h3>ðŸ’° Manage User Balance</h3>
                    <div class="form-group">
                        <label>User ID</label>
                        <input type="text" id="userIdForBalance" class="form-control" placeholder="Enter user UID">
                    </div>
                    <div class="form-group">
                        <label>New Balance</label>
                        <input type="number" id="newUserBalance" class="form-control" min="0">
                    </div>
                    <button class="btn btn-primary" id="updateBalanceBtn">Update Balance</button>
                </div>
            </div>
            
            <!-- Personal Messages Tab -->
            <div id="personalContent" class="admin-panel-content">
                <div class="admin-section">
                    <h3>ðŸ“© Send Personal Message</h3>
                    <div class="form-group">
                        <label>Select User</label>
                        <select id="personalMessageUser" class="form-control">
                            <option value="all">All Users</option>
                            <!-- Users will be populated here -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Title</label>
                        <input type="text" id="personalMessageTitle" class="form-control">
                    </div>
                    <div class="form-group">
                        <label>Message</label>
                        <textarea id="personalMessageContent" class="form-control" rows="4"></textarea>
                    </div>
                    <button class="btn btn-primary" id="sendPersonalMessageBtn">Send Message</button>
                </div>
            </div>
            
            <div style="margin-top: 25px; text-align: center;">
                <button class="btn btn-secondary" id="closeAdminPanelBtn">Close Admin Panel</button>
            </div>
        </div>
    </div>

    <!-- Instructions Modal -->
    <div id="instructionsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ðŸ“‹ Game Instructions</h2>
                <button class="close-modal" id="closeInstructionsModal">&times;</button>
            </div>
            <div class="terms-content">
                <h3>How to Play:</h3>
                <p><strong>1. Manual Mining:</strong> Tap the gold pile in the mining area to earn coins. Each tap gives you 1 coin.</p>
                <p><strong>2. Auto Mining:</strong> Enable auto mining to earn 0.1 coins per second for 2 hours. You can restart it after it ends.</p>
                <p><strong>3. Staking:</strong> Stake 2000 coins to earn 1 gem after 3 days. Gems can be used for exclusive rewards.</p>
                <p><strong>4. Store:</strong> Buy diamonds or redeem coupon codes to get gems instantly.</p>
                <p><strong>5. Referrals:</strong> Share your referral code with friends. When they sign up using your code, you both get 10 coins bonus.</p>
                <p><strong>6. Ranks:</strong> Progress through 4 ranks (Beginner to Expert) by being active and referring friends.</p>
                
                <h3>Important Notes:</h3>
                <p>- One account per Gmail and phone number only</p>
                <p>- Auto-tapping or cheating tools are prohibited</p>
                <p>- Withdrawals will be available after official coin price announcement</p>
                <p>- Contact your Assistant Mining Agent for deposits</p>
                
                <h3>Rewards:</h3>
                <p>- Senior Assistant Level: Eligible for up to $200/month (requires 30 referrals in one week, 90 in three weeks)</p>
                <p>- Maintain at least 2 referrals per day to qualify for rewards,Terms and conditions apply</p>
            </div>
            <button class="btn btn-primary" id="closeInstructionsBtn">Close</button>
        </div>
    </div>

    <!-- Customer Service Modal -->
    <div id="customerServiceModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ðŸ‘¨â€ðŸ’¼ Customer Service</h2>
                <button class="close-modal" id="closeCustomerServiceModal">&times;</button>
            </div>
            <div class="terms-content">
                <h3>Need Help?</h3>
                <p>If you have any questions, issues, or need assistance with your account, please contact our customer service team.</p>
                
                <h3>Email Support:</h3>
                <p>ðŸ“§ <strong>uscash4gmail.com</strong></p>
                <p>Our support team will respond to your queries within 24 hours.</p>
                
                <h3>Common Issues:</h3>
                <p>- Account verification problems</p>
                <p>- Mining or staking issues</p>
                <p>- Referral bonus not received</p>
                <p>- Deposit assistance needed</p>
                <p>- General game questions</p>
                
                <h3>Important:</h3>
                <p>Please include your user ID and email address in all communications for faster resolution.</p>
            </div>
            <button class="btn btn-primary" id="closeCustomerServiceBtn">Close</button>
        </div>
    </div>
    
    <!-- Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, updateDoc, onSnapshot, collection, query, orderBy, addDoc, serverTimestamp, where, getDocs } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAxkcz5xCEIBnvPkLdQf_7aKcIPFNsf3u0",
            authDomain: "goldmining-7f702.firebaseapp.com",
            projectId: "goldmining-7f702",
            storageBucket: "goldmining-7f702.firebasestorage.app",
            messagingSenderId: "631626307433",
            appId: "1:631626307433:web:81c8e4c05f70a399e8cff8"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        // Make Firebase available globally
        window.firebaseApp = app;
        window.firebaseAuth = auth;
        window.firebaseFirestore = db;
        window.firebaseFunctions = {
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            signOut,
            onAuthStateChanged,
            doc,
            setDoc,
            getDoc,
            updateDoc,
            onSnapshot,
            collection,
            query,
            orderBy,
            addDoc,
            serverTimestamp,
            where,
            getDocs
        };
    </script>
    
    <!-- Welcome Animation Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const goldPiece = document.getElementById('goldPiece');
            const welcomeText = document.getElementById('welcomeText');
            const skipButton = document.getElementById('skipButton');
            const boyLeft = document.getElementById('boyLeft');
            const boyRight = document.getElementById('boyRight');
            const leftBoyRightArm = document.getElementById('leftBoyRightArm');
            const rightBoyLeftArm = document.getElementById('rightBoyLeftArm');
            const animationContainer = document.getElementById('animationContainer');
            
            // Create particles for background
            createParticles();
            
            // Start the animation sequence
            setTimeout(startAnimation, 1000);
            
            function startAnimation() {
                // First throw - left to right
                goldPiece.style.left = '20%';
                goldPiece.style.bottom = '170px';
                goldPiece.style.opacity = '1';
                
                // Animate left boy throwing
                leftBoyRightArm.style.animation = 'arm-throw 1s ease-in-out';
                
                setTimeout(() => {
                    goldPiece.style.animation = 'throw-left-to-right 1.5s ease-in-out';
                    
                    // Animate right boy catching
                    setTimeout(() => {
                        rightBoyLeftArm.style.animation = 'arm-catch 0.5s ease-in-out';
                        boyRight.style.animation = 'boy-bounce 0.5s ease-in-out';
                    }, 1300);
                }, 300);
                
                // Second throw - right to left
                setTimeout(() => {
                    // Animate right boy throwing
                    rightBoyLeftArm.style.animation = 'arm-throw 1s ease-in-out';
                    
                    setTimeout(() => {
                        goldPiece.style.animation = 'throw-right-to-left 1.5s ease-in-out';
                        
                        // Animate left boy catching
                        setTimeout(() => {
                            leftBoyRightArm.style.animation = 'arm-catch 0.5s ease-in-out';
                            boyLeft.style.animation = 'boy-bounce 0.5s ease-in-out';
                        }, 1300);
                    }, 300);
                }, 3000);
                
                // Third throw - towards screen with text reveal
                setTimeout(() => {
                    // Animate left boy throwing towards screen
                    leftBoyRightArm.style.animation = 'arm-throw 1s ease-in-out';
                    
                    setTimeout(() => {
                        goldPiece.style.animation = 'throw-to-screen 2s ease-in-out forwards';
                        
                        // Show welcome text
                        setTimeout(() => {
                            welcomeText.style.opacity = '1';
                            welcomeText.style.animation = 'text-reveal 1.5s ease-out forwards';
                            
                            // Create celebration sparks
                            createCelebrationSparks();
                            
                            // Auto transition to auth after animation completes
                            setTimeout(() => {
                                hideAnimation();
                            }, 3000);
                        }, 1500);
                    }, 300);
                }, 6000);
            }
            
            function createParticles() {
                const particlesContainer = document.getElementById('particles');
                
                for (let i = 0; i < 25; i++) {
                    const particle = document.createElement('div');
                    particle.style.position = 'absolute';
                    particle.style.width = Math.random() * 4 + 2 + 'px';
                    particle.style.height = particle.style.width;
                    particle.style.backgroundColor = '#ffd700';
                    particle.style.borderRadius = '50%';
                    particle.style.opacity = Math.random() * 0.5 + 0.1;
                    
                    // Random position
                    particle.style.left = Math.random() * 100 + 'vw';
                    particle.style.top = Math.random() * 100 + 'vh';
                    
                    particlesContainer.appendChild(particle);
                    
                    // Animate particle
                    const animation = particle.animate([
                        { transform: 'translateY(0px)' },
                        { transform: 'translateY(-15px)' }
                    ], {
                        duration: 2000 + Math.random() * 3000,
                        iterations: Infinity,
                        direction: 'alternate',
                        easing: 'ease-in-out'
                    });
                }
            }
            
            function createCelebrationSparks() {
                for (let i = 0; i < 40; i++) {
                    setTimeout(() => {
                        createSpark(
                            Math.random() * window.innerWidth,
                            Math.random() * window.innerHeight
                        );
                    }, i * 100);
                }
            }
            
            function createSpark(x, y) {
                const spark = document.createElement('div');
                spark.className = 'spark';
                spark.style.left = x + 'px';
                spark.style.top = y + 'px';
                document.querySelector('.welcome-scene').appendChild(spark);
                
                // Animate spark
                spark.animate([
                    { opacity: 1, transform: 'scale(1)' },
                    { opacity: 0, transform: 'scale(2)' }
                ], {
                    duration: 500 + Math.random() * 500,
                    easing: 'ease-out'
                });
                
                // Remove spark after animation
                setTimeout(() => {
                    spark.remove();
                }, 1000);
            }
            
            function hideAnimation() {
                animationContainer.style.opacity = '0';
                animationContainer.style.transition = 'opacity 0.5s ease-out';
                setTimeout(() => {
                    animationContainer.style.display = 'none';
                    document.getElementById('authSection').style.display = 'flex';
                }, 500);
            }
            
            // Skip button functionality
            skipButton.addEventListener('click', function() {
                hideAnimation();
            });
        });
    </script>
    
    <!-- Game Logic -->
    <script>
        // DOM Elements
        const authSection = document.getElementById('authSection');
        const dashboardSection = document.getElementById('dashboardSection');
        const loginTab = document.getElementById('loginTab');
        const signupTab = document.getElementById('signupTab');
        const loginForm = document.getElementById('loginForm');
        const signupForm = document.getElementById('signupForm');
        const authMessage = document.getElementById('authMessage');
        const balanceDisplay = document.getElementById('balanceDisplay');
        const totalBalance = document.getElementById('totalBalance');
        const miningZone = document.getElementById('miningZone');
        const autoMiningToggle = document.getElementById('autoMiningToggle');
        const timerProgress = document.getElementById('timerProgress');
        const timerText = document.getElementById('timerText');
        const referralCount = document.getElementById('referralCount');
        const referralCode = document.getElementById('referralCode');
        const userRank = document.getElementById('userRank');
        const announcementIcon = document.getElementById('announcementIcon');
        const announcementBadge = document.getElementById('announcementBadge');
        const termsModal = document.getElementById('termsModal');
        const closeTermsModal = document.getElementById('closeTermsModal');
        const agreeCheckbox = document.getElementById('agreeCheckbox');
        const agreeButton = document.getElementById('agreeButton');
        const announcementsModal = document.getElementById('announcementsModal');
        const closeAnnouncementsModal = document.getElementById('closeAnnouncementsModal');
        const announcementsList = document.getElementById('announcementsList');
        
        // Gems & Staking Feature Elements
        const gemsDisplay = document.getElementById('gemsDisplay');
        const totalGems = document.getElementById('totalGems');
        const stakeCoinsBtn = document.getElementById('stakeCoinsBtn');
        const stakingModal = document.getElementById('stakingModal');
        const closeStakingModal = document.getElementById('closeStakingModal');
        const stakeAmount = document.getElementById('stakeAmount');
        const gemsToReceive = document.getElementById('gemsToReceive');
        const confirmStakeBtn = document.getElementById('confirmStakeBtn');
        const activeStakingList = document.getElementById('activeStakingList');
        
        // Store Feature Elements
        const storeBtn = document.getElementById('storeBtn');
        const storeModal = document.getElementById('storeModal');
        const closeStoreModal = document.getElementById('closeStoreModal');
        const submitCouponBtn = document.getElementById('submitCouponBtn');
        const couponCode = document.getElementById('couponCode');
        const pendingPopup = document.getElementById('pendingPopup');
        const storeMenuItem = document.getElementById('storeMenuItem');
        
        // Admin Panel Elements
        const adminPanel = document.getElementById('adminPanel');
        const closeAdminModal = document.getElementById('closeAdminModal');
        const sendAnnouncementBtn = document.getElementById('sendAnnouncementBtn');
        const updateRankBtn = document.getElementById('updateRankBtn');
        const updateBalanceBtn = document.getElementById('updateBalanceBtn');
        const closeAdminPanelBtn = document.getElementById('closeAdminPanelBtn');
        const loadUsersBtn = document.getElementById('loadUsersBtn');
        const usersList = document.getElementById('usersList');
        const sendPersonalMessageBtn = document.getElementById('sendPersonalMessageBtn');
        const refreshBtn = document.getElementById('refreshBtn');
        
        // Admin Tabs
        const announcementsTab = document.getElementById('announcementsTab');
        const usersTab = document.getElementById('usersTab');
        const personalTab = document.getElementById('personalTab');
        const announcementsContent = document.getElementById('announcementsContent');
        const usersContent = document.getElementById('usersContent');
        const personalContent = document.getElementById('personalContent');
        
        // New Menu Elements
        const menuIcon = document.getElementById('menuIcon');
        const menuDropdown = document.getElementById('menuDropdown');
        const instructionsMenuItem = document.getElementById('instructionsMenuItem');
        const termsMenuItem = document.getElementById('termsMenuItem');
        const customerServiceMenuItem = document.getElementById('customerServiceMenuItem');
        const logoutMenuItem = document.getElementById('logoutMenuItem');
        const instructionsModal = document.getElementById('instructionsModal');
        const closeInstructionsModal = document.getElementById('closeInstructionsModal');
        const closeInstructionsBtn = document.getElementById('closeInstructionsBtn');
        const customerServiceModal = document.getElementById('customerServiceModal');
        const closeCustomerServiceModal = document.getElementById('closeCustomerServiceModal');
        const closeCustomerServiceBtn = document.getElementById('closeCustomerServiceBtn');
        
        // Game State
        let userData = {
            uid: null,
            email: null,
            phone: null,
            balance: 0,
            coins: 0,
            referrals: 0,
            role: 'user',
            rank: 1,
            lastLogin: null,
            autoMiningEnd: null,
            agreedToTerms: false,
            lastSeenAnnouncement: null
        };
        
        let autoMiningInterval = null;
        let autoMiningTimeLeft = 0;
        let autoMiningTotalTime = 2 * 60 * 60; // 2 hours in seconds
        let announcements = [];
        let unreadAnnouncementsCount = 0;
        
        // Gems & Staking Feature State
        let gems = 0;
        let activeStakes = [];
        let stakingCheckInterval = null;
        
        // Auth Tab Switching
        loginTab.addEventListener('click', () => {
            loginTab.classList.add('active');
            signupTab.classList.remove('active');
            loginForm.classList.add('active');
            signupForm.classList.remove('active');
            authMessage.style.display = 'none';
        });
        
        signupTab.addEventListener('click', () => {
            signupTab.classList.add('active');
            loginTab.classList.remove('active');
            signupForm.classList.add('active');
            loginForm.classList.remove('active');
            authMessage.style.display = 'none';
        });
        
        // Login Form Submission
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            try {
                const userCredential = await window.firebaseFunctions.signInWithEmailAndPassword(
                    window.firebaseAuth, email, password
                );
                const user = userCredential.user;
                
                // Show success message
                showSuccessMessage('Login successful!');
                
                // Load user data from Firestore
                await loadUserData(user.uid);
                
            } catch (error) {
                showAuthMessage(error.message);
            }
        });
        
        // Signup Form Submission
        signupForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const phone = document.getElementById('signupPhone').value;
            const referral = document.getElementById('signupReferral').value;
            
            try {
                const userCredential = await window.firebaseFunctions.createUserWithEmailAndPassword(
                    window.firebaseAuth, email, password
                );
                const user = userCredential.user;
                
                // Show success message
                showSuccessMessage('Account created successfully!');
                
                // Create user data in Firestore
                const userDataToSave = {
                    uid: user.uid,
                    email: email,
                    phone: phone,
                    balance: 0,
                    coins: 0,
                    referrals: 0,
                    role: 'user',
                    rank: 1,
                    lastLogin: new Date().toISOString(),
                    autoMiningEnd: null,
                    agreedToTerms: false,
                    lastSeenAnnouncement: null,
                    gems: 0
                };
                
                await window.firebaseFunctions.setDoc(
                    window.firebaseFunctions.doc(window.firebaseFirestore, "users", user.uid),
                    userDataToSave
                );
                
                // Set the userData object
                userData = userDataToSave;
                
                // Handle referral if provided
                if (referral) {
                    await handleReferral(referral, user.uid);
                }
                
                // Show terms modal
                showTermsModal();
                
            } catch (error) {
                showAuthMessage(error.message);
            }
        });
        
        // Logout
        logoutMenuItem.addEventListener('click', async () => {
            try {
                await window.firebaseFunctions.signOut(window.firebaseAuth);
                showAuth();
                resetGameState();
            } catch (error) {
                console.error('Logout error:', error);
            }
        });
        
        // Mining Zone Click
        miningZone.addEventListener('click', (e) => {
            if (!userData.uid) return;
            
            // Update balance - ONE TAP = ONE COIN ONLY
            userData.balance += 1;
            userData.coins += 1;
            
            // Update display
            updateBalanceDisplay();
            
            // Save to Firestore
            saveUserData();
            
            // Show +1 animation
            showPlusOneAnimation(e);
            
            // Play sparkle effect
            playSparkleEffect();
        });
        
        // Auto Mining Toggle
        autoMiningToggle.addEventListener('change', (e) => {
            if (e.target.checked) {
                startAutoMining();
            } else {
                stopAutoMining();
            }
        });
        
        // Terms Modal
        agreeCheckbox.addEventListener('change', (e) => {
            agreeButton.disabled = !e.target.checked;
        });
        
        agreeButton.addEventListener('click', () => {
            userData.agreedToTerms = true;
            saveUserData();
            hideTermsModal();
        });
        
        closeTermsModal.addEventListener('click', hideTermsModal);
        
        // Announcements
        announcementIcon.addEventListener('click', () => {
            showAnnouncementsModal();
        });
        
        closeAnnouncementsModal.addEventListener('click', hideAnnouncementsModal);
        
        // Gems & Staking Feature Event Listeners
        stakeCoinsBtn.addEventListener('click', () => {
            showStakingModal();
        });
        
        closeStakingModal.addEventListener('click', hideStakingModal);
        
        stakeAmount.addEventListener('input', (e) => {
            const amount = parseInt(e.target.value) || 0;
            const gems = Math.floor(amount / 2000);
            gemsToReceive.textContent = gems;
        });
        
        confirmStakeBtn.addEventListener('click', async () => {
            await createStaking();
        });
        
        // Store Feature Event Listeners
        storeBtn.addEventListener('click', () => {
            showStoreModal();
        });
        
        storeMenuItem.addEventListener('click', () => {
            showStoreModal();
            hideMenu();
        });
        
        closeStoreModal.addEventListener('click', hideStoreModal);
        
        // Buy buttons in store
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('btn-primary') && e.target.closest('.package-item')) {
                const diamonds = parseInt(e.target.getAttribute('data-diamonds'));
                const price = parseFloat(e.target.getAttribute('data-price'));
                showPendingPopup(diamonds, price);
            }
        });
        
        submitCouponBtn.addEventListener('click', () => {
            redeemCoupon();
        });
        
        // Admin Panel Event Listeners
        closeAdminModal.addEventListener('click', hideAdminPanel);
        closeAdminPanelBtn.addEventListener('click', hideAdminPanel);
        sendAnnouncementBtn.addEventListener('click', sendAnnouncement);
        updateRankBtn.addEventListener('click', updateUserRank);
        updateBalanceBtn.addEventListener('click', updateUserBalance);
        loadUsersBtn.addEventListener('click', loadAllUsers);
        sendPersonalMessageBtn.addEventListener('click', sendPersonalMessage);
        refreshBtn.addEventListener('click', refreshBalance);
        
        // Admin Tabs
        announcementsTab.addEventListener('click', () => {
            setActiveAdminTab('announcements');
        });
        
        usersTab.addEventListener('click', () => {
            setActiveAdminTab('users');
        });
        
        personalTab.addEventListener('click', () => {
            setActiveAdminTab('personal');
        });
        
        // New Menu Event Listeners
        menuIcon.addEventListener('click', toggleMenu);
        instructionsMenuItem.addEventListener('click', showInstructionsModal);
        termsMenuItem.addEventListener('click', showTermsModal);
        customerServiceMenuItem.addEventListener('click', showCustomerServiceModal);
        closeInstructionsModal.addEventListener('click', hideInstructionsModal);
        closeInstructionsBtn.addEventListener('click', hideInstructionsModal);
        closeCustomerServiceModal.addEventListener('click', hideCustomerServiceModal);
        closeCustomerServiceBtn.addEventListener('click', hideCustomerServiceModal);
        
        // Close menu when clicking outside
        document.addEventListener('click', (e) => {
            if (!menuIcon.contains(e.target) && !menuDropdown.contains(e.target)) {
                menuDropdown.style.display = 'none';
            }
        });
        
        // Functions
        function showAuthMessage(message) {
            authMessage.textContent = message;
            authMessage.style.display = 'block';
        }

        function showSuccessMessage(message) {
            const successMsg = document.createElement('div');
            successMsg.className = 'success-message';
            successMsg.textContent = message;
            document.body.appendChild(successMsg);
            
            setTimeout(() => {
                successMsg.remove();
            }, 2000);
        }
        
        function showAuth() {
            authSection.style.display = 'flex';
            dashboardSection.style.display = 'none';
        }
        
        function showDashboard() {
            authSection.style.display = 'none';
            dashboardSection.style.display = 'block';
            updateBalanceDisplay();
            updateReferralDisplay();
            
            // Check if auto mining is active
            if (userData.autoMiningEnd) {
                const endTime = new Date(userData.autoMiningEnd).getTime();
                const now = new Date().getTime();
                
                if (endTime > now) {
                    autoMiningTimeLeft = Math.floor((endTime - now) / 1000);
                    startAutoMining();
                } else {
                    // Auto mining has ended
                    userData.autoMiningEnd = null;
                    saveUserData();
                }
            }
            
            // Load announcements
            loadAnnouncements();
            
            // Load staking data
            loadStakingRecords();
            startStakingCheckInterval();

            // Add admin button if user is admin
            addAdminButton();
        }
        
        async function loadUserData(uid) {
            try {
                const docRef = window.firebaseFunctions.doc(window.firebaseFirestore, "users", uid);
                const docSnap = await window.firebaseFunctions.getDoc(docRef);
                
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    userData = data;
                    userData.uid = uid;
                    
                    // Load gems
                    gems = data.gems || 0;
                    
                    // Update last login
                    userData.lastLogin = new Date().toISOString();
                    await saveUserData();
                    
                    // Show dashboard after loading user data
                    showDashboard();
                    
                    // Set up real-time listener for user data
                    window.firebaseFunctions.onSnapshot(docRef, (doc) => {
                        if (doc.exists()) {
                            const updatedData = doc.data();
                            userData.balance = updatedData.balance;
                            userData.coins = updatedData.coins;
                            userData.referrals = updatedData.referrals;
                            userData.rank = updatedData.rank || 1;
                            gems = updatedData.gems || 0;
                            updateBalanceDisplay();
                            updateReferralDisplay();
                            updateRankDisplay();
                        }
                    });
                    
                    // Show terms modal if user hasn't agreed yet
                    if (!userData.agreedToTerms) {
                        showTermsModal();
                    }
                } else {
                    // User document doesn't exist - create it
                    await createUserDocument(uid);
                }
            } catch (error) {
                console.error('Error loading user data:', error);
                showAuthMessage('Error loading user data. Please try again.');
            }
        }
        
        async function createUserDocument(uid) {
            try {
                const user = window.firebaseAuth.currentUser;
                if (!user) return;
                
                const userDataToSave = {
                    uid: uid,
                    email: user.email,
                    phone: '',
                    balance: 0,
                    coins: 0,
                    referrals: 0,
                    role: 'user',
                    rank: 1,
                    lastLogin: new Date().toISOString(),
                    autoMiningEnd: null,
                    agreedToTerms: false,
                    lastSeenAnnouncement: null,
                    gems: 0
                };
                
                await window.firebaseFunctions.setDoc(
                    window.firebaseFunctions.doc(window.firebaseFirestore, "users", uid),
                    userDataToSave
                );
                
                userData = userDataToSave;
                showDashboard();
                showTermsModal();
            } catch (error) {
                console.error('Error creating user document:', error);
                showAuthMessage('Error creating user profile. Please try again.');
            }
        }
        
        async function saveUserData() {
            if (!userData.uid) return;
            
            try {
                const docRef = window.firebaseFunctions.doc(window.firebaseFirestore, "users", userData.uid);
                await window.firebaseFunctions.updateDoc(docRef, {
                    ...userData,
                    gems: gems
                });
            } catch (error) {
                console.error('Error saving user data:', error);
            }
        }
        
        function updateBalanceDisplay() {
            // Format balance to 2 decimal places
            const formattedBalance = parseFloat(userData.balance).toFixed(2);
            balanceDisplay.textContent = `${formattedBalance} Coins`;
            totalBalance.textContent = `${formattedBalance} Coins`;
            gemsDisplay.textContent = `ðŸ’Ž ${gems} Gems`;
            totalGems.textContent = `ðŸ’Ž ${gems} Gems`;
        }
        
        function updateReferralDisplay() {
            referralCount.textContent = userData.referrals;
            referralCode.textContent = userData.uid || 'Loading...';
        }
        
        function updateRankDisplay() {
            userRank.textContent = `Rank ${userData.rank || 1}`;
        }
        
        function showPlusOneAnimation(e) {
            const plusOne = document.createElement('span');
            plusOne.innerText = '+1';
            plusOne.style.position = 'absolute';
            plusOne.style.left = e.pageX - 10 + 'px';
            plusOne.style.top = e.pageY - 20 + 'px';
            plusOne.style.color = '#FFD700';
            plusOne.style.fontWeight = 'bold';
            plusOne.style.fontSize = '18px';
            plusOne.style.opacity = '1';
            plusOne.style.transition = 'all 0.8s ease-out';
            plusOne.style.zIndex = '1000';
            plusOne.style.pointerEvents = 'none';
            plusOne.style.textShadow = '2px 2px 0 #8B4513';
            
            document.body.appendChild(plusOne);
            
            setTimeout(() => {
                plusOne.style.top = (e.pageY - 60) + 'px';
                plusOne.style.opacity = '0';
            }, 100);
            
            setTimeout(() => {
                plusOne.remove();
            }, 900);
        }
        
        function playSparkleEffect() {
            const goldPile = document.querySelector('.gold-pile');
            goldPile.style.boxShadow = '0 0 30px rgba(255, 215, 0, 1), inset 0 0 15px rgba(255, 255, 255, 0.7)';
            
            setTimeout(() => {
                goldPile.style.boxShadow = '0 0 20px rgba(255, 215, 0, 0.9), inset 0 0 10px rgba(255, 255, 255, 0.5)';
            }, 300);
        }
        
        function startAutoMining() {
            autoMiningToggle.checked = true;
            
            // Set auto mining end time if not already set
            if (!userData.autoMiningEnd) {
                const endTime = new Date();
                endTime.setHours(endTime.getHours() + 2);
                userData.autoMiningEnd = endTime.toISOString();
                autoMiningTimeLeft = autoMiningTotalTime;
                saveUserData();
            } else {
                // Calculate time left from stored end time
                const endTime = new Date(userData.autoMiningEnd).getTime();
                const now = new Date().getTime();
                autoMiningTimeLeft = Math.floor((endTime - now) / 1000);
            }
            
            // Update auto mining status display
            document.getElementById('autoMiningStatus').textContent = 'Active';
            
            // Start the interval
            if (autoMiningInterval) clearInterval(autoMiningInterval);
            
            autoMiningInterval = setInterval(() => {
                if (autoMiningTimeLeft <= 0) {
                    stopAutoMining();
                    return;
                }
                
                // Add coins every second
                userData.balance += 0.1;
                userData.coins += 0.1;
                
                // Update display
                updateBalanceDisplay();
                
                // Update timer
                autoMiningTimeLeft--;
                updateAutoMiningTimer();
                
                // Save every 30 seconds
                if (autoMiningTimeLeft % 30 === 0) {
                    saveUserData();
                }
                
            }, 1000);
            
            updateAutoMiningTimer();
        }
        
        function stopAutoMining() {
            autoMiningToggle.checked = false;
            
            if (autoMiningInterval) {
                clearInterval(autoMiningInterval);
                autoMiningInterval = null;
            }
            
            userData.autoMiningEnd = null;
            saveUserData();
            
            timerProgress.style.width = '0%';
            timerText.textContent = 'Auto Mining: Inactive';
            document.getElementById('autoMiningStatus').textContent = 'Inactive';
        }
        
        function updateAutoMiningTimer() {
            const percentage = ((autoMiningTotalTime - autoMiningTimeLeft) / autoMiningTotalTime) * 100;
            timerProgress.style.width = `${percentage}%`;
            
            const hours = Math.floor(autoMiningTimeLeft / 3600);
            const minutes = Math.floor((autoMiningTimeLeft % 3600) / 60);
            const seconds = autoMiningTimeLeft % 60;
            
            timerText.textContent = `Auto Mining: ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        function showTermsModal() {
            termsModal.style.display = 'flex';
            hideMenu();
        }
        
        function hideTermsModal() {
            termsModal.style.display = 'none';
        }
        
        function showAnnouncementsModal() {
            announcementsModal.style.display = 'flex';
            // Mark announcements as seen
            markAnnouncementsAsSeen();
        }
        
        function hideAnnouncementsModal() {
            announcementsModal.style.display = 'none';
        }
        
        function resetGameState() {
            userData = {
                uid: null,
                email: null,
                phone: null,
                balance: 0,
                coins: 0,
                referrals: 0,
                role: 'user',
                rank: 1,
                lastLogin: null,
                autoMiningEnd: null,
                agreedToTerms: false,
                lastSeenAnnouncement: null
            };
            
            gems = 0;
            activeStakes = [];
            if (stakingCheckInterval) {
                clearInterval(stakingCheckInterval);
                stakingCheckInterval = null;
            }
            
            if (autoMiningInterval) {
                clearInterval(autoMiningInterval);
                autoMiningInterval = null;
            }
            
            autoMiningTimeLeft = 0;
            timerProgress.style.width = '0%';
            timerText.textContent = 'Auto Mining: Inactive';
        }
        
        async function handleReferral(referralCode, newUserId) {
            try {
                // Find the user with this referral code
                const docRef = window.firebaseFunctions.doc(window.firebaseFirestore, "users", referralCode);
                const docSnap = await window.firebaseFunctions.getDoc(docRef);
                
                if (docSnap.exists()) {
                    const referrerData = docSnap.data();
                    
                    // Update referrer's referral count
                    await window.firebaseFunctions.updateDoc(docRef, {
                        referrals: referrerData.referrals + 1
                    });
                    
                    // Give bonus to new user
                    userData.balance += 10;
                    userData.coins += 10;
                    updateBalanceDisplay();
                    saveUserData();
                }
            } catch (error) {
                console.error('Error handling referral:', error);
            }
        }
        
        // Announcements Functions
        async function loadAnnouncements() {
            try {
                const announcementsRef = window.firebaseFunctions.collection(window.firebaseFirestore, "announcements");
                const q = window.firebaseFunctions.query(announcementsRef, window.firebaseFunctions.orderBy("timestamp", "desc"));
                
                window.firebaseFunctions.onSnapshot(q, (querySnapshot) => {
                    announcements = [];
                    querySnapshot.forEach((doc) => {
                        announcements.push({
                            id: doc.id,
                            ...doc.data()
                        });
                    });
                    
                    renderAnnouncements();
                    updateUnreadAnnouncementsCount();
                });
            } catch (error) {
                console.error('Error loading announcements:', error);
            }
        }
        
        function renderAnnouncements() {
            announcementsList.innerHTML = '';
            
            if (announcements.length === 0) {
                announcementsList.innerHTML = '<div class="no-announcements">No announcements available</div>';
                return;
            }
            
            announcements.forEach(announcement => {
                const announcementItem = document.createElement('div');
                announcementItem.className = 'announcement-item';
                
                const announcementDate = new Date(announcement.timestamp?.toDate() || new Date()).toLocaleDateString();
                
                announcementItem.innerHTML = `
                    <div class="announcement-title">
                        <span>${announcement.title || 'Announcement'}</span>
                        <span class="announcement-date">${announcementDate}</span>
                    </div>
                    <div class="announcement-content">${announcement.content || ''}</div>
                `;
                
                announcementsList.appendChild(announcementItem);
            });
        }
        
        function updateUnreadAnnouncementsCount() {
            if (!userData.lastSeenAnnouncement || announcements.length === 0) {
                unreadAnnouncementsCount = announcements.length;
            } else {
                // Find the index of the last seen announcement
                const lastSeenIndex = announcements.findIndex(a => a.id === userData.lastSeenAnnouncement);
                unreadAnnouncementsCount = lastSeenIndex === -1 ? announcements.length : announcements.length - (lastSeenIndex + 1);
            }
            
            if (unreadAnnouncementsCount > 0) {
                announcementBadge.textContent = unreadAnnouncementsCount;
                announcementBadge.style.display = 'flex';
            } else {
                announcementBadge.style.display = 'none';
            }
        }
        
        function markAnnouncementsAsSeen() {
            if (announcements.length > 0) {
                userData.lastSeenAnnouncement = announcements[0].id;
                saveUserData();
                unreadAnnouncementsCount = 0;
                announcementBadge.style.display = 'none';
            }
        }
        
        // Gems & Staking Feature Functions
        function showStakingModal() {
            stakingModal.style.display = 'flex';
            // Reset stake amount to minimum
            stakeAmount.value = 2000;
            gemsToReceive.textContent = 1;
        }
        
        function hideStakingModal() {
            stakingModal.style.display = 'none';
        }
        
        async function createStaking() {
            const amount = parseInt(stakeAmount.value);
            
            // Validation
            if (amount < 2000) {
                alert('Minimum staking amount is 2000 coins');
                return;
            }
            
            if (amount > userData.balance) {
                alert('You do not have enough coins');
                return;
            }
            
            if (amount % 2000 !== 0) {
                alert('Amount must be in multiples of 2000 coins');
                return;
            }
            
            try {
                // Deduct coins from balance
                userData.balance -= amount;
                userData.coins -= amount;
                updateBalanceDisplay();
                
                // Create staking record
                const stakingRef = window.firebaseFunctions.collection(
                    window.firebaseFirestore, 
                    "users", 
                    userData.uid, 
                    "staking"
                );
                
                const startTime = new Date();
                const endTime = new Date(startTime.getTime() + 3 * 24 * 60 * 60 * 1000); // 3 days
                const gemsToEarn = amount / 2000;
                
                const stakingRecord = {
                    amount: amount,
                    startTime: startTime.toISOString(),
                    endTime: endTime.toISOString(),
                    status: "active",
                    convertedGems: gemsToEarn
                };
                
                await window.firebaseFunctions.addDoc(stakingRef, stakingRecord);
                
                // Save user data
                await saveUserData();
                
                // Hide modal and show success
                hideStakingModal();
                showSuccessMessage(`Successfully staked ${amount} coins! You will receive ${gemsToEarn} gems in 3 days.`);
                
                // Reload staking records
                loadStakingRecords();
                
            } catch (error) {
                console.error('Error creating staking:', error);
                alert('Error creating staking. Please try again.');
                // Refund coins if error
                userData.balance += amount;
                userData.coins += amount;
                updateBalanceDisplay();
            }
        }
        
        async function loadStakingRecords() {
            if (!userData.uid) return;
            
            try {
                const stakingRef = window.firebaseFunctions.collection(
                    window.firebaseFirestore, 
                    "users", 
                    userData.uid, 
                    "staking"
                );
                const q = window.firebaseFunctions.query(
                    stakingRef, 
                    window.firebaseFunctions.where("status", "==", "active")
                );
                
                const querySnapshot = await window.firebaseFunctions.getDocs(q);
                activeStakes = [];
                
                querySnapshot.forEach((doc) => {
                    activeStakes.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                renderActiveStakes();
                
            } catch (error) {
                console.error('Error loading staking records:', error);
            }
        }
        
        function renderActiveStakes() {
            activeStakingList.innerHTML = '';
            
            if (activeStakes.length === 0) {
                activeStakingList.innerHTML = '<div class="no-staking">No active staking</div>';
                return;
            }
            
            activeStakes.forEach(stake => {
                const stakeItem = document.createElement('div');
                stakeItem.className = 'staking-item';
                
                const endTime = new Date(stake.endTime);
                const now = new Date();
                const timeLeft = endTime - now;
                
                let timeText = "Completed!";
                if (timeLeft > 0) {
                    const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                    
                    timeText = `${days}d ${hours}h ${minutes}m ${seconds}s`;
                }
                
                stakeItem.innerHTML = `
                    <div class="staking-amount">${stake.amount} Coins â†’ ${stake.convertedGems} Gems</div>
                    <div class="staking-countdown">Ends in: ${timeText}</div>
                `;
                
                activeStakingList.appendChild(stakeItem);
            });
        }
        
        async function checkAndCompleteStakes() {
            if (!userData.uid || activeStakes.length === 0) return;
            
            const now = new Date();
            let updated = false;
            
            for (const stake of activeStakes) {
                const endTime = new Date(stake.endTime);
                
                if (endTime <= now && stake.status === "active") {
                    // Complete this stake
                    try {
                        const stakeRef = window.firebaseFunctions.doc(
                            window.firebaseFirestore, 
                            "users", 
                            userData.uid, 
                            "staking", 
                            stake.id
                        );
                        
                        // Update stake status
                        await window.firebaseFunctions.updateDoc(stakeRef, {
                            status: "completed"
                        });
                        
                        // Add gems to user
                        gems += stake.convertedGems;
                        updateBalanceDisplay();
                        
                        // Save user data
                        await saveUserData();
                        
                        // Show gem animation
                        showGemAnimation(stake.convertedGems);
                        
                        updated = true;
                        
                    } catch (error) {
                        console.error('Error completing stake:', error);
                    }
                }
            }
            
            if (updated) {
                // Reload staking records
                loadStakingRecords();
            }
        }
        
        function startStakingCheckInterval() {
            // Check every 10 seconds for completed stakes
            stakingCheckInterval = setInterval(() => {
                checkAndCompleteStakes();
                renderActiveStakes(); // Update countdown display
            }, 10000);
        }
        
        function showGemAnimation(gemCount) {
            for (let i = 0; i < Math.min(gemCount, 10); i++) {
                setTimeout(() => {
                    const gem = document.createElement('div');
                    gem.className = 'gem-animation';
                    gem.innerHTML = 'ðŸ’Ž';
                    gem.style.left = Math.random() * 80 + 10 + '%';
                    gem.style.top = '80%';
                    
                    document.body.appendChild(gem);
                    
                    setTimeout(() => {
                        gem.remove();
                    }, 2000);
                }, i * 200);
            }
            
            // Show notification
            setTimeout(() => {
                showSuccessMessage(`ðŸŽ‰ You received ${gemCount} gems from staking!`);
            }, 500);
        }

        // Store Feature Functions
        function showStoreModal() {
            storeModal.style.display = 'flex';
        }
        
        function hideStoreModal() {
            storeModal.style.display = 'none';
        }
        
        function showPendingPopup(diamonds, price) {
            pendingPopup.style.display = 'flex';
            
            // Simulate processing for 3 seconds
            setTimeout(() => {
                hidePendingPopup();
                // In a real app, this would be where you process the payment
                // For now, we'll just add the diamonds to the user's gems
                gems += diamonds;
                updateBalanceDisplay();
                saveUserData();
                // Updated store feedback message
                showSuccessMessage("Thank you! Your request is pending. If the transaction is confirmed as correct, you will receive your diamonds shortly.");
            }, 3000);
        }
        
        function hidePendingPopup() {
            pendingPopup.style.display = 'none';
        }
        
        function redeemCoupon() {
            const code = couponCode.value.trim();
            
            if (!code) {
                alert('Please enter a coupon code');
                return;
            }
            
            // Show pending popup
            pendingPopup.style.display = 'flex';
            
            // Simulate processing for 3 seconds
            setTimeout(() => {
                hidePendingPopup();
                
                // In a real app, you would validate the coupon code against a database
                // For now, we'll simulate a successful redemption
                if (code.toLowerCase() === 'welcome10') {
                    gems += 10;
                    updateBalanceDisplay();
                    saveUserData();
                    // Updated store feedback message
                    showSuccessMessage("Thank you! Your request is pending. If the transaction is confirmed as correct, you will receive your diamonds shortly.");
                    couponCode.value = '';
                } else if (code.toLowerCase() === 'goldmine25') {
                    gems += 25;
                    updateBalanceDisplay();
                    saveUserData();
                    // Updated store feedback message
                    showSuccessMessage("Thank you! Your request is pending. If the transaction is confirmed as correct, you will receive your diamonds shortly.");
                    couponCode.value = '';
                } else {
                    alert('Invalid coupon code. Please try again.');
                }
            }, 3000);
        }

        // Admin Panel Functions
        function showAdminPanel() {
            if (isAdminUser()) {
                adminPanel.style.display = 'flex';
                // Load users for personal messages dropdown
                loadUsersForDropdown();
            } else {
                alert('Access denied. Admin privileges required.');
            }
        }
        
        function hideAdminPanel() {
            adminPanel.style.display = 'none';
        }
        
        function setActiveAdminTab(tabName) {
            // Remove active class from all tabs and content
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.admin-panel-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Add active class to selected tab and content
            document.getElementById(`${tabName}Tab`).classList.add('active');
            document.getElementById(`${tabName}Content`).classList.add('active');
        }
        
        function isAdminUser() {
            // Only these two emails have admin access
            const adminEmails = ['kafe2999@gmail.com', 'cptanil1995@gmail.com'];
            return userData && adminEmails.includes(userData.email);
        }
        
        function addAdminButton() {
            if (isAdminUser()) {
                // Check if admin button already exists
                if (!document.getElementById('adminBtn')) {
                    const adminBtn = document.createElement('button');
                    adminBtn.id = 'adminBtn';
                    adminBtn.className = 'btn btn-secondary';
                    adminBtn.innerHTML = 'ðŸ”§ Admin';
                    adminBtn.onclick = showAdminPanel;
                    adminBtn.style.marginLeft = '8px';
                    
                    document.querySelector('.user-info').appendChild(adminBtn);
                }
            }
        }
        
        async function sendAnnouncement() {
            const title = document.getElementById('announcementTitle').value;
            const content = document.getElementById('announcementContent').value;
            
            if (!title || !content) {
                alert('Please fill in both title and content');
                return;
            }
            
            try {
                const announcementsRef = window.firebaseFunctions.collection(window.firebaseFirestore, "announcements");
                await window.firebaseFunctions.addDoc(announcementsRef, {
                    title: title,
                    content: content,
                    timestamp: window.firebaseFunctions.serverTimestamp(),
                    createdBy: userData.uid
                });
                
                alert('Announcement sent successfully!');
                document.getElementById('announcementTitle').value = '';
                document.getElementById('announcementContent').value = '';
            } catch (error) {
                console.error('Error sending announcement:', error);
                alert('Error sending announcement: ' + error.message);
            }
        }
        
        async function updateUserRank() {
            const userId = document.getElementById('userIdForRank').value;
            const newRank = document.getElementById('newUserRank').value;
            
            if (!userId) {
                alert('Please enter a user ID');
                return;
            }
            
            try {
                const userRef = window.firebaseFunctions.doc(window.firebaseFirestore, "users", userId);
                await window.firebaseFunctions.updateDoc(userRef, {
                    rank: parseInt(newRank)
                });
                
                alert(`User rank updated to ${newRank} successfully!`);
                document.getElementById('userIdForRank').value = '';
            } catch (error) {
                console.error('Error updating user rank:', error);
                alert('Error updating user rank: ' + error.message);
            }
        }
        
        async function updateUserBalance() {
            const userId = document.getElementById('userIdForBalance').value;
            const newBalance = parseInt(document.getElementById('newUserBalance').value);
            
            if (!userId || isNaN(newBalance)) {
                alert('Please enter valid user ID and balance');
                return;
            }
            
            try {
                const userRef = window.firebaseFunctions.doc(window.firebaseFirestore, "users", userId);
                await window.firebaseFunctions.updateDoc(userRef, {
                    balance: newBalance,
                    coins: newBalance
                });
                
                alert(`User balance updated to ${newBalance} successfully!`);
                document.getElementById('userIdForBalance').value = '';
                document.getElementById('newUserBalance').value = '';
            } catch (error) {
                console.error('Error updating user balance:', error);
                alert('Error updating user balance: ' + error.message);
            }
        }
        
        async function loadAllUsers() {
            try {
                const usersRef = window.firebaseFunctions.collection(window.firebaseFirestore, "users");
                const querySnapshot = await window.firebaseFunctions.getDocs(usersRef);
                
                usersList.innerHTML = '';
                
                if (querySnapshot.empty) {
                    usersList.innerHTML = '<div class="no-announcements">No users found</div>';
                    return;
                }
                
                querySnapshot.forEach((doc) => {
                    const user = doc.data();
                    const userItem = document.createElement('div');
                    userItem.className = 'user-item';
                    
                    userItem.innerHTML = `
                        <div class="user-info-small">
                            <div class="user-email">${user.email}</div>
                            <div class="user-stats">
                                <span>Rank: ${user.rank || 1}</span>
                                <span>Balance: ${parseFloat(user.balance || 0).toFixed(2)}</span>
                                <span>Gems: ${user.gems || 0}</span>
                            </div>
                        </div>
                        <div class="user-actions">
                            <button class="btn btn-secondary" onclick="promptUpdateRank('${doc.id}')">Update Rank</button>
                            <button class="btn btn-secondary" onclick="promptUpdateBalance('${doc.id}')">Update Balance</button>
                        </div>
                    `;
                    
                    usersList.appendChild(userItem);
                });
                
            } catch (error) {
                console.error('Error loading users:', error);
                alert('Error loading users: ' + error.message);
            }
        }
        
        async function loadUsersForDropdown() {
            try {
                const usersRef = window.firebaseFunctions.collection(window.firebaseFirestore, "users");
                const querySnapshot = await window.firebaseFunctions.getDocs(usersRef);
                
                const dropdown = document.getElementById('personalMessageUser');
                // Clear existing options except "All Users"
                while (dropdown.children.length > 1) {
                    dropdown.removeChild(dropdown.lastChild);
                }
                
                querySnapshot.forEach((doc) => {
                    const user = doc.data();
                    const option = document.createElement('option');
                    option.value = doc.id;
                    option.textContent = user.email;
                    dropdown.appendChild(option);
                });
                
            } catch (error) {
                console.error('Error loading users for dropdown:', error);
            }
        }
        
        async function sendPersonalMessage() {
            const userId = document.getElementById('personalMessageUser').value;
            const title = document.getElementById('personalMessageTitle').value;
            const content = document.getElementById('personalMessageContent').value;
            
            if (!title || !content) {
                alert('Please fill in both title and content');
                return;
            }
            
            try {
                // For "all" users, we need to create personal messages for each user
                if (userId === 'all') {
                    // Get all users
                    const usersRef = window.firebaseFunctions.collection(window.firebaseFirestore, "users");
                    const querySnapshot = await window.firebaseFunctions.getDocs(usersRef);
                    
                    // Create a personal message for each user
                    const promises = [];
                    querySnapshot.forEach((userDoc) => {
                        const personalMessage = {
                            userId: userDoc.id,
                            title: title,
                            content: content,
                            timestamp: window.firebaseFunctions.serverTimestamp(),
                            sentBy: userData.uid,
                            isRead: false
                        };
                        
                        // Store in the user's personalMessages subcollection
                        const userPersonalMessagesRef = window.firebaseFunctions.collection(
                            window.firebaseFirestore, 
                            "users", 
                            userDoc.id, 
                            "personalMessages"
                        );
                        
                        promises.push(window.firebaseFunctions.addDoc(userPersonalMessagesRef, personalMessage));
                    });
                    
                    await Promise.all(promises);
                    alert('Personal message sent to all users successfully!');
                } else {
                    // Send to specific user
                    const personalMessage = {
                        userId: userId,
                        title: title,
                        content: content,
                        timestamp: window.firebaseFunctions.serverTimestamp(),
                        sentBy: userData.uid,
                        isRead: false
                    };
                    
                    // Store in the user's personalMessages subcollection
                    const userPersonalMessagesRef = window.firebaseFunctions.collection(
                        window.firebaseFirestore, 
                        "users", 
                        userId, 
                        "personalMessages"
                    );
                    
                    await window.firebaseFunctions.addDoc(userPersonalMessagesRef, personalMessage);
                    alert('Personal message sent successfully!');
                }
                
                document.getElementById('personalMessageTitle').value = '';
                document.getElementById('personalMessageContent').value = '';
                
            } catch (error) {
                console.error('Error sending personal message:', error);
                alert('Error sending personal message: ' + error.message);
            }
        }
        
        function refreshBalance() {
            // Add a spinning animation to the refresh button
            const refreshIcon = refreshBtn.querySelector('span') || refreshBtn;
            refreshIcon.style.animation = 'spin 1s linear';
            
            setTimeout(() => {
                refreshIcon.style.animation = '';
            }, 1000);
            
            // Force update the balance display
            updateBalanceDisplay();
            
            // Show success message
            showSuccessMessage('Balance refreshed!');
        }
        
        // New Menu Functions
        function toggleMenu() {
            if (menuDropdown.style.display === 'block') {
                menuDropdown.style.display = 'none';
            } else {
                menuDropdown.style.display = 'block';
            }
        }
        
        function hideMenu() {
            menuDropdown.style.display = 'none';
        }
        
        function showInstructionsModal() {
            instructionsModal.style.display = 'flex';
            hideMenu();
        }
        
        function hideInstructionsModal() {
            instructionsModal.style.display = 'none';
        }
        
        function showCustomerServiceModal() {
            customerServiceModal.style.display = 'flex';
            hideMenu();
        }
        
        function hideCustomerServiceModal() {
            customerServiceModal.style.display = 'none';
        }
        
        // Global functions for user actions
        window.promptUpdateRank = function(userId) {
            const newRank = prompt('Enter new rank (1-4):');
            if (newRank && newRank >= 1 && newRank <= 4) {
                updateSpecificUserRank(userId, parseInt(newRank));
            } else {
                alert('Invalid rank. Please enter a number between 1 and 4.');
            }
        };
        
        window.promptUpdateBalance = function(userId) {
            const newBalance = prompt('Enter new balance:');
            if (newBalance && !isNaN(newBalance)) {
                updateSpecificUserBalance(userId, parseFloat(newBalance));
            } else {
                alert('Invalid balance. Please enter a valid number.');
            }
        };
        
        async function updateSpecificUserRank(userId, newRank) {
            try {
                const userRef = window.firebaseFunctions.doc(window.firebaseFirestore, "users", userId);
                await window.firebaseFunctions.updateDoc(userRef, {
                    rank: newRank
                });
                
                alert(`User rank updated to ${newRank} successfully!`);
                // Reload users list
                loadAllUsers();
            } catch (error) {
                console.error('Error updating user rank:', error);
                alert('Error updating user rank: ' + error.message);
            }
        }
        
        async function updateSpecificUserBalance(userId, newBalance) {
            try {
                const userRef = window.firebaseFunctions.doc(window.firebaseFirestore, "users", userId);
                await window.firebaseFunctions.updateDoc(userRef, {
                    balance: newBalance,
                    coins: newBalance
                });
                
                alert(`User balance updated to ${newBalance} successfully!`);
                // Reload users list
                loadAllUsers();
            } catch (error) {
                console.error('Error updating user balance:', error);
                alert('Error updating user balance: ' + error.message);
            }
        }
        
        // Initialize
        // The welcome animation will automatically transition to auth after completion
        
        // Check if user is already logged in
        window.firebaseFunctions.onAuthStateChanged(window.firebaseAuth, (user) => {
            if (user) {
                // User is signed in
                loadUserData(user.uid);
            } else {
                // User is signed out
                showAuth();
            }
        });
        
        // For testing: Add sample announcements (remove in production)
        setTimeout(async () => {
            // Only add sample announcements if none exist
            try {
                const announcementsRef = window.firebaseFunctions.collection(window.firebaseFirestore, "announcements");
                const q = window.firebaseFunctions.query(announcementsRef);
                const querySnapshot = await window.firebaseFunctions.getDocs(q);
                
                if (querySnapshot.empty) {
                    // Add sample announcements
                    const sampleAnnouncements = [
                        {
                            title: "Welcome to GoldMinning!",
                            content: "We're excited to have you on board. Start mining coins and invite friends to earn bonuses!",
                            timestamp: window.firebaseFunctions.serverTimestamp()
                        },
                        {
                            title: "Auto Mining Feature",
                            content: "Remember to activate Auto Mining to earn coins even when you're not actively playing!",
                            timestamp: window.firebaseFunctions.serverTimestamp()
                        },
                        {
                            title: "Referral Bonus Increased",
                            content: "We've increased the referral bonus to 10 coins for each friend who signs up using your code!",
                            timestamp: window.firebaseFunctions.serverTimestamp()
                        }
                    ];
                    
                    for (const announcement of sampleAnnouncements) {
                        await window.firebaseFunctions.addDoc(announcementsRef, announcement);
                    }
                }
            } catch (error) {
                console.error('Error adding sample announcements:', error);
            }
        }, 2000);
    </script>
</body>
</html>
